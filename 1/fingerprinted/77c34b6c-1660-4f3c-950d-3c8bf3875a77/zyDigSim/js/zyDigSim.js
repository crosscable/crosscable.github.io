define("zyDigSim",["exports"],function(exports){function Component(a,b,c,d,e,f){switch(this.x=a,this.y=b,this.width=0,this.height=0,this.inputPorts=[],this.outputPorts=[],this.inputs=[],this.outputs=[],this.name="",this.value=0,this.elements=[],this.maxInput=0,this.bitWidth=d,this.elementType=c,this.displayValue=!1,this.inToolBox=void 0!==e?e:!0,this.shouldDraw=void 0!==f?f:!0,c){case Component.IN:this.buildInput();break;case Component.OUT:this.buildOutput();break;case Component.ADDER:this.buildAdder();break;case Component.COMPARATOR:this.buildComparator();break;case Component.MUX:this.buildMux();break;case Component.LOAD_REGISTER:this.buildLoadRegister();break;case Component.CONSTANT:this.buildConstant()}}function createInternalAND(){return new Element(0,0,null,ELEMENT_FUNCTIONS.AND,2,"pass","")}function createInternalOR(){return new Element(0,0,null,ELEMENT_FUNCTIONS.OR,2,"pass","")}function createInternalNOR(){return new Element(0,0,null,ELEMENT_FUNCTIONS.NOR,2,"pass","")}function createInternalNOT(){return new Element(0,0,null,ELEMENT_FUNCTIONS.NOT,1,"pass","")}function createInternalXOR(){return new Element(0,0,null,ELEMENT_FUNCTIONS.XOR,2,"pass","")}function createInternalStorage(){return new Element(0,0,null,ELEMENT_FUNCTIONS.NONE,1,"pass","")}function Element(a,b,c,d,e,f,g,h){this.x=a,this.y=b,this.img=c,this.inputs=new Array,this.outputs=new Array,this.maxInput=e,this.operation=d,this.value=0,this.elementType=f,this.name=g,this.labelID=null,this.width=c?c.width:64,this.height=c?c.height:48,this.bitWidth=1,this.inputPorts=[],this.outputPorts=[],this.shouldDraw=!0;for(var i=this.height/(this.maxInput+1),j=0,k=i;j<this.maxInput;j++,k+=i)this.inputPorts.push(new Port(this.x-HALF_WIRE_LENGTH,this.y+k,1)),this.inputs.push(null);f!=Element.OUT&&(this.outputPorts.push(new Port(this.x+this.width-HALF_WIRE_LENGTH,this.y+this.height/2,1)),this.outputPorts[0].updateName("",!0)),this.inToolBox=void 0!==h?h:!0}function InternalCell(){this.input=null,this.outputs=[],this.value=0}function Port(a,b,c,d){this.x=a,this.y=b,this.bitWidth=c,this.connectors=[],this.name="",this.vertical=void 0!==d?d:!1,this.isOutput=!1,this.value=0;for(var e=0;c>e;e++)this.connectors[e]=new InternalCell;this.vertical?(this.height=WIRE_LENGTH,this.width=1):(this.height=1,this.width=WIRE_LENGTH)}function Question(a,b,c){a=a,this.equation=a,this.discreteMathEquation=b,this.display="z = "+(c||a)}function ZyDigSim(){function getRandomInt(a,b){return Math.floor(Math.random()*(b-a+1))+a}this.init=function(a,b,c){this.name="zyDigSim",this.id=a,this.parentResource=b,this.useMultipleParts=!1,this.isProgressionTool=!1,this.useComponents=!1;var d="";c&&("useMultipleParts"in c&&(this.useMultipleParts=c.useMultipleParts),"progressive"in c&&(this.isProgressionTool=c.progressive),"useComponents"in c&&(this.useComponents=c.useComponents),"useDiscreteMathNotation"in c&&(this.useDiscreteMathNotation=c.useDiscreteMathNotation),"circuit"in c?d=c.circuit:"JSONToLoad"in c&&(d=c.JSONToLoad));var e=["Example D latch","Example half adder","Example decoder (2x4)"];if(this.useComponents&&(e=["Example datapath with mux and adder"]),this.latexPrefix="\\(",this.latexPostfix="\\)",this.utilities=require("utilities"),this.discreteMathUtilities=require("discreteMathUtilities"),this.css='<style>.zyante-bold{font-family:HelveticaNeue-Light,"Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;font-weight:300}.zyante-section-bold{font-family:Helvetica;font-weight:300}.zyDigSim{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;position:relative}.zyDigSim .bottom-buttons{margin-top:10px}.zyDigSim .component-input{color:#5780a6;font:HelveticaNeue-Light,"Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;height:40px;position:absolute;text-align:center;width:40px;z-index:1}.zyDigSim .delete-selected-items-button{margin-bottom:15px}.zyDigSim .example-drop{display:inline-block;margin-left:30px}.zyDigSim .gate-pointer{cursor:pointer}.zyDigSim .generated-text{font-family:Comic Sans MS;font-size:12px}.zyDigSim .import-button{display:inline-block;margin-left:30px}.zyDigSim .JSON-import-export{margin-top:10px;resize:none}.zyDigSim .label{background-color:transparent;border:0;color:#5780a6;font-size:14pt;height:auto;outline:0;overflow:hidden;padding:2.5px;position:absolute;resize:none;width:auto}.zyDigSim .legend-canvas{position:absolute;box-shadow:0 0 5px #333;-moz-box-shadow:0 0 5px #333;-webkit-box-shadow:0 0 5px #333;pointer-events:none;z-index:1}.zyDigSim .logic-canvas-container{border:1px solid #ccc;display:inline-block;height:480px;overflow:scroll;position:relative;vertical-align:top;width:640px}.zyDigSim .logic-context-menu-container{background-color:#fff;border:1px solid gray;box-shadow:2px 2px 1px gray;display:none;position:absolute;width:125px}.zyDigSim .logic-context-menu-item:hover{background-color:gray}.zyDigSim .logic-context-menu-items{background-color:#fff;list-style:none;margin:5px;padding:0}.zyDigSim .middle-container-cover.active{opacity:.3}.zyDigSim .middle-container-cover .middle-container{position:relative}.zyDigSim .problem1.assign1{left:217px;position:absolute;top:65px}.zyDigSim .problem2.assign1{left:170px;position:absolute;top:25px}.zyDigSim .problem2.assign2{left:170px;position:absolute;top:130px}.zyDigSim .problem3.assign1{left:96px;position:absolute;top:50px}.zyDigSim .problem3.assign2{left:307px;position:absolute;top:50px}.zyDigSim .problem3.assign3{left:92px;position:absolute;top:167px}.zyDigSim .problem3.assign4{left:280px;position:absolute;top:167px}.zyDigSim .problem4.assign1{left:96px;position:absolute;top:50px}.zyDigSim .problem4.assign2{left:307px;position:absolute;top:50px}.zyDigSim .problem4.assign3{left:92px;position:absolute;top:167px}.zyDigSim .problem4.assign4{left:280px;position:absolute;top:167px}.zyDigSim .problem5.assign1{left:150px;position:absolute;top:65px}.zyDigSim .problem5.assign2{left:150px;position:absolute;top:167px}.zyDigSim .problem5.condition1{left:235px;position:absolute;top:0}.zyDigSim .problem5.condition2{left:160px;position:absolute;top:100px}.zyDigSim .problem5.condition3{left:235px;position:absolute;top:200px}.zyDigSim .problem5.condition4{left:235px;position:absolute;top:125px}.zyDigSim .progression-container{margin-bottom:10px;text-align:center}.zyDigSim .progression-image{vertical-align:middle}.zyDigSim .progression-image-container{display:inline-block;position:relative;text-align:center;vertical-align:middle;width:345px}.zyDigSim .progression-prompt{color:#5780a6;display:inline-block;font-size:20px;height:30px;text-align:center;vertical-align:middle;width:385px}.zyDigSim .reset-button{background-color:#fff;color:#5780a6}.zyDigSim .reset-button:hover:not(.disabled){background-color:#fff}.zyDigSim .toolbox-canvas{vertical-align:top}.zyDigSim .toolbox-container{display:inline-block;margin-left:5px;position:relative;text-align:left;width:200px}.zyDigSim .toolbox-container div.instruction-label{color:#5780a6;font-size:12px}.zyDigSim .user-variable{font-style:italic}.zyDigSim .undo-button{margin-bottom:15px}.zyDigSim .zyante-progression-explanation-area{user-select:text}.zyDigSim .zyante-progression-explanation-area td{text-align:center}</style>',this.html=this[this.name].template({id:a,isProgressionTool:this.isProgressionTool,examples:e}),this.isProgressionTool){var f=7;this.useComponents?f=5:this.useDiscreteMathNotation&&(f=8);var g=!1,h=!1,i=-1;this.progressionTool=require("progressionTool").create();var j=this;this.progressionTool.init(this.id,this.parentResource,{html:this.html,css:this.css,numToWin:f,useMultipleParts:this.useMultipleParts,start:function(){j.setAllowedToEdit(!0),j.reset(),j.useComponents&&j.loadGates(),j.currentProblem=j.generateProgressionQuestion(0),j.displayNextQuestion(j.currentProblem,0,-1),j.resetUndoRedoStack(),i=0,h=!1},reset:function(){$("#progressionPrompt_"+j.id).text(""),j.setAllowedToEdit(!1),j.reset(),j.tryAgain=!1,j.useComponents&&($("#progressionPrompt_"+j.id).text(""),$("#"+j.id+" .progression-image").hide(),$("#"+j.id+" .generated-text").hide(),$("#"+j.id+" .progression-container").animate({height:0},500))},next:function(a){j.setAllowedToEdit(!0),j.tryAgain||(g&&j.useComponents||j.reset(),j.useComponents&&j.loadGates(),j.currentProblem=j.generateProgressionQuestion(a),j.displayNextQuestion(j.currentProblem,a,i),j.resetUndoRedoStack()),j.tryAgain=!1,g=!1,i=a},isCorrect:function(a){var b=j.verifyQuestion(j.currentProblem);return answerIsCorrect=b.isCorrect,j.setAllowedToEdit(!1),g=!answerIsCorrect,b}}),this.$middleContainerCover=$("#"+this.id+" .middle-container-cover"),this.valueType={CONSTANT:0,RANDOM8:1}}else{$("#"+this.id).html(this.css+this.html);var j=this;$("#"+this.id).click(function(){var a={part:0,complete:!0,metadata:{event:"zyDigSim clicked"}};j.parentResource.postEvent(a)})}null!==c?this.initZyDigSim(this.id,this.parentResource,this.name,c.canEdit,c.canExport,c.toolBoxEnabled,c.width,c.height,d,c.basicOnly,c.scrollable,c.progressive,c.useComponents,c.useGates):this.initZyDigSim(this.id,this.parentResource,this.name),this.isProgressionTool&&this.setAllowedToEdit(!1)},this.zyDigSim=this.zyDigSim||{},this.zyDigSim.explanation=Handlebars.template({1:function(a,b,c,d,e){var f,g=a.lambda,h=a.escapeExpression;return"                <tr>\n                    <th class='"+h(g(null!=b?b["class"]:b,b))+"'>"+h(g(null!=b?b.name:b,b))+"</th>\n"+(null!=(f=c.each.call(null!=b?b:a.nullContext||{},null!=b?b.values:b,{name:"each",hash:{},fn:a.program(2,e,0),inverse:a.noop,data:e}))?f:"")+"                </tr>\n"},2:function(a,b,c,d,e){return"                        <td>"+a.escapeExpression(a.lambda(b,b))+"</td>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:a.nullContext||{};return a.escapeExpression((g=null!=(g=c.explanation||(null!=b?b.explanation:b))?g:c.helperMissing,"function"==typeof g?g.call(h,{name:"explanation",hash:{},data:e}):g))+"\n<div class='table'>\n    <table>\n        <tbody>\n"+(null!=(f=c.each.call(h,null!=b?b.records:b,{name:"each",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+"        </tbody>\n    </table>\n</div>\n"},useData:!0}),this.zyDigSim.template=Handlebars.template({1:function(a,b,c,d,e){var f,g=null!=b?b:a.nullContext||{},h=c.helperMissing,i="function",j=a.escapeExpression;return"    <div class='progression-container'>\n        <div id='progressionPrompt_"+j((f=null!=(f=c.id||(null!=b?b.id:b))?f:h,("undefined"==typeof f?"undefined":_typeof(f))===i?f.call(g,{name:"id",hash:{},data:e}):f))+"' class='progression-prompt'></div>\n        <div id='progressionImageContainer_"+j((f=null!=(f=c.id||(null!=b?b.id:b))?f:h,("undefined"==typeof f?"undefined":_typeof(f))===i?f.call(g,{name:"id",hash:{},data:e}):f))+"' class='progression-image-container'>\n            <img id='progressionImage1_"+j((f=null!=(f=c.id||(null!=b?b.id:b))?f:h,("undefined"==typeof f?"undefined":_typeof(f))===i?f.call(g,{name:"id",hash:{},data:e}):f))+"' class='progression-image'></img>\n            <img id='progressionImage2_"+j((f=null!=(f=c.id||(null!=b?b.id:b))?f:h,("undefined"==typeof f?"undefined":_typeof(f))===i?f.call(g,{name:"id",hash:{},data:e}):f))+"' class='progression-image'></img>\n            <img id='progressionImage3_"+j((f=null!=(f=c.id||(null!=b?b.id:b))?f:h,("undefined"==typeof f?"undefined":_typeof(f))===i?f.call(g,{name:"id",hash:{},data:e}):f))+"' class='progression-image'></img>\n            <img id='progressionImage4_"+j((f=null!=(f=c.id||(null!=b?b.id:b))?f:h,("undefined"==typeof f?"undefined":_typeof(f))===i?f.call(g,{name:"id",hash:{},data:e}):f))+"' class='progression-image'></img>\n            <img id='progressionImage5_"+j((f=null!=(f=c.id||(null!=b?b.id:b))?f:h,("undefined"==typeof f?"undefined":_typeof(f))===i?f.call(g,{name:"id",hash:{},data:e}):f))+"' class='progression-image'></img>\n        </div>\n    </div>\n"},3:function(a,b,c,d,e){return"            <option>"+a.escapeExpression(a.lambda(b,b))+"</option>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g,h=null!=b?b:a.nullContext||{},i=c.helperMissing,j="function",k=a.escapeExpression;return"<button id='resetButton_"+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,("undefined"==typeof g?"undefined":_typeof(g))===j?g.call(h,{name:"id",hash:{},data:e}):g))+"' class='reset-button button'>Reset</button>\n\n"+(null!=(f=c["if"].call(h,null!=b?b.isProgressionTool:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.noop,data:e}))?f:"")+"\n<div class='middle-container-cover'>\n    <div class='middle-container'>\n        <input type='number' class='component-input'/>\n        <canvas id='legendCanvas_"+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,("undefined"==typeof g?"undefined":_typeof(g))===j?g.call(h,{name:"id",hash:{},data:e}):g))+"' width='120' height='30' class='legend-canvas'></canvas>\n        <div id='logicCanvasContainer_"+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,("undefined"==typeof g?"undefined":_typeof(g))===j?g.call(h,{name:"id",hash:{},data:e}):g))+"' class='logic-canvas-container'>\n            <canvas id='logicCanvas_"+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,("undefined"==typeof g?"undefined":_typeof(g))===j?g.call(h,{name:"id",hash:{},data:e}):g))+"' width='1600' height='960'></canvas>\n        </div>\n        <div class='toolbox-container'>\n            <button id='deleteSelectedItemsButton_"+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,("undefined"==typeof g?"undefined":_typeof(g))===j?g.call(h,{name:"id",hash:{},data:e}):g))+"' class='delete-selected-items-button button'>Delete selected item(s)</button>\n            <button id='undoButton_"+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,("undefined"==typeof g?"undefined":_typeof(g))===j?g.call(h,{name:"id",hash:{},data:e}):g))+"' class='undo-button button'>Undo</button>\n            <div class='instruction-label'>Click to add.</div>\n            <canvas id='toolBoxCanvas_"+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,("undefined"==typeof g?"undefined":_typeof(g))===j?g.call(h,{name:"id",hash:{},data:e}):g))+"' class='toolbox-canvas' width='250' height='400'></canvas>\n        </div>\n    </div>\n</div>\n\n<div class='bottom-buttons'>\n    <button id='exportBtn_"+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,("undefined"==typeof g?"undefined":_typeof(g))===j?g.call(h,{name:"id",hash:{},data:e}):g))+"' class='export-button button'>Export &darr;</button>\n    <button id='importBtn_"+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,("undefined"==typeof g?"undefined":_typeof(g))===j?g.call(h,{name:"id",hash:{},data:e}):g))+"' class='import-button button'>Import &uarr;</button>\n    <select id='exampleDrop_"+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,("undefined"==typeof g?"undefined":_typeof(g))===j?g.call(h,{name:"id",hash:{},data:e}):g))+"' class='example-drop'>\n"+(null!=(f=c.each.call(h,null!=b?b.examples:b,{name:"each",hash:{},fn:a.program(3,e,0),inverse:a.noop,data:e}))?f:"")+"    </select>\n    <br/>\n</div>\n\n<textarea id='JSONLoadSave_"+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,("undefined"==typeof g?"undefined":_typeof(g))===j?g.call(h,{name:"id",hash:{},data:e}):g))+"' class='JSON-import-export textfield' rows='4' cols='50'></textarea>\n<div id='deleteContextMenu_"+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,("undefined"==typeof g?"undefined":_typeof(g))===j?g.call(h,{name:"id",hash:{},data:e}):g))+"' class='logic-context-menu-container'>\n    <ul id='deleteOptions_"+k((g=null!=(g=c.id||(null!=b?b.id:b))?g:i,("undefined"==typeof g?"undefined":_typeof(g))===j?g.call(h,{name:"id",hash:{},data:e}):g))+"' class='logic-context-menu-items'>\n      <li class='logic-context-menu-item'>Delete wire</li>\n  </ul>\n</div>\n"},useData:!0}),this.loadGates=function(){this.Dgt=this.getElementThatContains("D_"),this.Ts=this.getElementByName("T_s"),this.Tld=this.getElementByName("T_ld"),this.clock=this.getElementByName("clk"),this.D=this.getElementByName("D"),this.T=this.getElementByName("T")},this.displayImage=function(a,b){$("#progressionPrompt_"+this.id).text("");var c=this;$("#"+this.id+" .progression-container").animate({height:a[0].naturalHeight},500,function(){a.show(),$("#"+c.id+" .problem"+(b+1)).show(),$("#progressionPrompt_"+c.id).text("Build the datapath for the given HLSM")})},this.displayNextQuestion=function(a,b,c){this.useComponents?($("#"+this.id+" .generated-text").hide(),b===c?$("#"+this.id+" .problem"+(b+1)).show():($("#"+this.id+" .progression-image").hide(),this.displayImage($("#progressionImage"+(b+1)+"_"+this.id),b))):this.useDiscreteMathNotation?($("#progressionPrompt_"+this.id).text(this.latexPrefix+a.display+this.latexPostfix),this.parentResource.latexChanged()):$("#progressionPrompt_"+this.id).text(a.display)},this.verifyQuestion=function(currentProblem){var answerIsCorrect=!1,explanation="",userAnswer="",expectedAnswer="",latexChanged=!1;if(this.useComponents){for(var w=0;w<currentProblem.solutions.length;w++)for(var j=0;j<currentProblem.solutions[w].length;j++){for(var i=0;i<currentProblem.solutions[w][j].inputs.length;i++)currentProblem.solutions[w][j].inputs[i].element=this.getElementByName(currentProblem.solutions[w][j].inputs[i].element.name);for(var i=0;i<currentProblem.solutions[w][j].outputs.length;i++)currentProblem.solutions[w][j].outputs[i].element=this.getElementByName(currentProblem.solutions[w][j].outputs[i].element.name)}for(var records=[],passedSolutions=[],incorrectCase=[],w=0;w<currentProblem.solutions.length;w++){records.push({}),answerIsCorrect=!0;for(var timesToVerfiy=3,oldT=this.T.value,currentCase=currentProblem.solutions[w],i=0;i<currentCase[0].inputs.length;i++)records[w][currentCase[0].inputs[i].element.name]={name:currentCase[0].inputs[i].element.name,values:[],"class":"test-variable"};records[w][this.clock.name]={name:this.clock.name,values:[],"class":"test-variable"};for(var i=0;i<currentCase[0].outputs.length;i++)records[w][currentCase[0].outputs[i].element.name]={name:currentCase[0].outputs[i].element.name,values:[],"class":"test-variable expected"},records[w]["Your "+currentCase[0].outputs[i].element.name]={name:"Your "+currentCase[0].outputs[i].element.name,values:[],"class":"user-variable"};for(var i=0;timesToVerfiy>i;i++)for(var j=0;j<currentCase.length;j++){for(var k=0;k<currentCase[j].inputs.length;k++)if(currentCase[j].inputs[k].valueType==this.valueType.CONSTANT)currentCase[j].inputs[k].element.value=currentCase[j].inputs[k].value,records[w][currentCase[j].inputs[k].element.name].values.push(currentCase[j].inputs[k].value),records[w][currentCase[j].inputs[k].element.name].values.push(currentCase[j].inputs[k].value);else if(currentCase[j].inputs[k].valueType==this.valueType.RANDOM8){var randomValue=getRandomInt(0,255);if(currentCase[j].inputs[k].comparisonOperation){var operation=currentCase[j].inputs[k].comparisonOperation,value=currentCase[j].inputs[k].comparisonValue;">"==operation?randomValue=i%2==0?getRandomInt(value+1,255):getRandomInt(0,value):"<"==operation?randomValue=i%2==0?getRandomInt(0,value-1):getRandomInt(value,255):"=="==operation&&(randomValue=i%2==0?value:getRandomInt(0,1)?getRandomInt(0,value-1):getRandomInt(value+1,255))}currentCase[j].inputs[k].element.value=randomValue,records[w][currentCase[j].inputs[k].element.name].values.push(randomValue),records[w][currentCase[j].inputs[k].element.name].values.push(randomValue)}records[w][this.clock.name].values.push(0),records[w][this.clock.name].values.push(1);for(var k=0;k<currentCase[j].outputs.length;k++){var operation=currentCase[j].outputs[k].dataOperation;operation=operation.replace("oldT",oldT),operation=operation.replace("D",this.D.value);var correctValue=eval(operation);"boolean"==typeof correctValue&&(correctValue=correctValue?1:0);var zeroValue=correctValue;this.clock.value=0,this.verifyUpdate(),"T"==currentCase[j].outputs[k].element.name&&(zeroValue=oldT),records[w][currentCase[j].outputs[k].element.name].values.push(zeroValue),records[w]["Your "+currentCase[j].outputs[k].element.name].values.push(currentCase[j].outputs[k].element.value),currentCase[j].outputs[k].element.value!=zeroValue&&(answerIsCorrect=!1,incorrectCase[w]=i),this.clock.value=1,this.verifyUpdate(),"T"==currentCase[j].outputs[k].element.name&&(oldT=correctValue),records[w][currentCase[j].outputs[k].element.name].values.push(correctValue),records[w]["Your "+currentCase[j].outputs[k].element.name].values.push(currentCase[j].outputs[k].element.value),currentCase[j].outputs[k].element.value!=correctValue&&(answerIsCorrect=!1,incorrectCase[w]=i)}}passedSolutions.push(answerIsCorrect)}answerIsCorrect=!1;for(var i=0;i<passedSolutions.length;i++)answerIsCorrect|=passedSolutions[i];if(answerIsCorrect)explanation="Correct";else if(0==this.getElementByType(Component.LOAD_REGISTER).length)explanation="Load register required to output data from datapath.";else{explanation="";for(var i=0;i<records.length;i++)if(!passedSolutions[i]&&!explanation){var recordsToDisplay=$.extend(!0,{},records[i]),explanationTableRows=[],expectedAnswersAdded=0;for(var propertyName in recordsToDisplay){var property=recordsToDisplay[propertyName],recordLength=property.values.length/timesToVerfiy;property.values.splice((incorrectCase[i]-1)*recordLength,incorrectCase[i]*recordLength),property.values.splice(incorrectCase[i]*recordLength+recordLength),property["class"].includes("expected")?(property.name="Expected "+property.name,explanationTableRows.push(property),expectedAnswersAdded++):explanationTableRows.splice(-expectedAnswersAdded,0,property)}explanation=this[this.name].explanation({explanation:"Your T does not match the expected T at every clock edge.",records:explanationTableRows})}}}else{userAnswer=this.buildCompleteEquation("digitalDesign");var userAnswerDM=this.buildCompleteEquation("proposition"),userAnswerLatex=this.buildCompleteEquation("latex");expectedAnswer=currentProblem.equation;var expectedAnswerDM=currentProblem.discreteMathEquation;if(this.discreteMathUtilities.areLogicallyEquivalentPropositions(userAnswerDM,expectedAnswerDM,["a","b","c"]))explanation="Correct",answerIsCorrect=!0;else if(""===userAnswer)explanation="Circuit incomplete. Use the toolbox on the right to create components. Connect the components to match the equation.",answerIsCorrect=!1,this.tryAgain=!0;else{var userAnswerDisplay="z = "+userAnswer,expectedAnswerDisplay=currentProblem.display;this.useDiscreteMathNotation&&(userAnswerDisplay=this.latexPrefix+"z = "+userAnswerLatex+this.latexPostfix,expectedAnswerDisplay=this.latexPrefix+expectedAnswerDisplay+this.latexPostfix),explanation="Your circuit's equation "+userAnswerDisplay+" does not match "+expectedAnswerDisplay+".",answerIsCorrect=!1,latexChanged=!0}}return{explanationMessage:explanation,userAnswer:userAnswer,expectedAnswer:expectedAnswer,isCorrect:answerIsCorrect,latexChanged:latexChanged}},this.convertToCarouselOfQuestions=function(a,b,c){var d=this,e=a.map(function(a,e){var f=b[e];if(d.useDiscreteMathNotation){var g=c?c[e]:d.convertNottedVariablesToLatexOverline(a);return new Question(a,f,g)}return new Question(a,f)});return this.utilities.getCarousel(e)},this.convertNottedVariablesToLatexOverline=function(a){for(var b=a,c=0;c<b.length;c++){var d=b[c];if("'"===d){var e=b.slice(0,c-1),f=b[c-1],g=b.slice(c+1,b.length);b=e+"\\overline{"+f+"}"+g}}return b},this.allPossibleVariableOrders=[["a","b","c"],["a","c","b"],["b","a","c"],["b","c","a"],["c","a","b"],["c","b","a"]],this.generateProgressionQuestionWithoutComponents=function(a){var b,c=[],d=[],e=this;if(0===a)this.questionOneCarousel||(this.allPossibleVariableOrders.forEach(function(a){c.push(a[0]+" + "+a[1]),d.push(a[0]+e.discreteMathUtilities.orSymbol+a[1])}),this.questionOneCarousel=this.convertToCarouselOfQuestions(c,d)),b=this.questionOneCarousel.getValue();else if(1===a)this.questionTwoCarousel||(this.allPossibleVariableOrders.forEach(function(a){c.push(a[0]+a[1]+" + "+a[2]),c.push(a[0]+" + "+a[1]+a[2]),d.push("("+a[0]+e.discreteMathUtilities.andSymbol+a[1]+")"+e.discreteMathUtilities.orSymbol+a[2]),d.push(a[0]+e.discreteMathUtilities.orSymbol+"("+a[1]+e.discreteMathUtilities.andSymbol+a[2]+")")}),this.questionTwoCarousel=this.convertToCarouselOfQuestions(c,d)),b=this.questionTwoCarousel.getValue();else if(2===a)this.questionThreeCarousel||(this.allPossibleVariableOrders.forEach(function(a){c.push(a[0]+"'"+a[1]),c.push(a[0]+a[1]+"'"),d.push(e.discreteMathUtilities.notSymbol+a[0]+e.discreteMathUtilities.andSymbol+a[1]),d.push(a[0]+e.discreteMathUtilities.andSymbol+e.discreteMathUtilities.notSymbol+a[1])}),this.questionThreeCarousel=this.convertToCarouselOfQuestions(c,d)),b=this.questionThreeCarousel.getValue();else if(3===a)this.questionFourCarousel||(this.allPossibleVariableOrders.forEach(function(a){c.push(a[0]+"'"+a[1]+" + "+a[2]),c.push(a[0]+a[1]+"' + "+a[2]),d.push("("+e.discreteMathUtilities.notSymbol+a[0]+e.discreteMathUtilities.andSymbol+a[1]+")"+e.discreteMathUtilities.orSymbol+a[2]),d.push("("+a[0]+e.discreteMathUtilities.andSymbol+e.discreteMathUtilities.notSymbol+a[1]+")"+e.discreteMathUtilities.orSymbol+a[2])}),this.questionFourCarousel=this.convertToCarouselOfQuestions(c,d)),b=this.questionFourCarousel.getValue();else if(4===a)this.questionFiveCarousel||(this.allPossibleVariableOrders.forEach(function(a){c.push(a[0]+"'"+a[1]+a[2]),c.push(a[0]+a[1]+"'"+a[2]),c.push(a[0]+a[1]+a[2]+"'"),d.push(e.discreteMathUtilities.notSymbol+a[0]+e.discreteMathUtilities.andSymbol+a[1]+e.discreteMathUtilities.andSymbol+a[2]),d.push(a[0]+e.discreteMathUtilities.andSymbol+e.discreteMathUtilities.notSymbol+a[1]+e.discreteMathUtilities.andSymbol+a[2]),d.push(a[0]+e.discreteMathUtilities.andSymbol+a[1]+e.discreteMathUtilities.andSymbol+e.discreteMathUtilities.notSymbol+a[2])}),this.questionFiveCarousel=this.convertToCarouselOfQuestions(c,d)),b=this.questionFiveCarousel.getValue();else if(5===a)this.questionSixCarousel||(this.allPossibleVariableOrders.forEach(function(a){c.push(a[0]+a[1]+" + "+a[0]+"'"+a[2]),c.push(a[0]+"'"+a[1]+" + "+a[0]+a[2]),d.push("("+a[0]+e.discreteMathUtilities.andSymbol+a[1]+")"+e.discreteMathUtilities.orSymbol+"("+e.discreteMathUtilities.notSymbol+a[0]+e.discreteMathUtilities.andSymbol+a[2]+")"),d.push("("+e.discreteMathUtilities.notSymbol+a[0]+e.discreteMathUtilities.andSymbol+a[1]+")"+e.discreteMathUtilities.orSymbol+"("+a[0]+e.discreteMathUtilities.andSymbol+a[2]+")")}),this.questionSixCarousel=this.convertToCarouselOfQuestions(c,d)),b=this.questionSixCarousel.getValue();else if(6===a)this.questionSevenCarousel||(this.allPossibleVariableOrders.forEach(function(a){c.push(a[0]+"'"+a[1]+" + "+a[0]+a[2]+"'"),c.push(a[0]+a[1]+"' + "+a[0]+"'"+a[2]),d.push("("+e.discreteMathUtilities.notSymbol+a[0]+e.discreteMathUtilities.andSymbol+a[1]+")"+e.discreteMathUtilities.orSymbol+"("+a[0]+e.discreteMathUtilities.andSymbol+e.discreteMathUtilities.notSymbol+a[2]+")"),d.push("("+a[0]+e.discreteMathUtilities.andSymbol+e.discreteMathUtilities.notSymbol+a[1]+")"+e.discreteMathUtilities.orSymbol+"("+e.discreteMathUtilities.notSymbol+a[0]+e.discreteMathUtilities.andSymbol+a[2]+")")}),this.questionSevenCarousel=this.convertToCarouselOfQuestions(c,d)),b=this.questionSevenCarousel.getValue();else if(7===a){var f=[];this.questionEightCarousel||(this.allPossibleVariableOrders.forEach(function(a){c.push("(("+a[0]+a[1]+") + "+a[2]+")'"),d.push(e.discreteMathUtilities.notSymbol+"(("+a[0]+e.discreteMathUtilities.andSymbol+a[1]+")"+e.discreteMathUtilities.orSymbol+a[2]+")"),f.push("\\overline{"+a[0]+a[1]+" + "+a[2]+"}")}),this.questionEightCarousel=this.convertToCarouselOfQuestions(c,d,f)),b=this.questionEightCarousel.getValue()}return b},this.generateProgressionQuestion=function(a){if(!this.useComponents)return this.generateProgressionQuestionWithoutComponents(a);if(0===a){var b=[],c=[];this.Dgt.shouldDraw=!1,this.Ts.shouldDraw=!1,this.Tld.shouldDraw=!0,this.clock.shouldDraw=!0,this.D.shouldDraw=!1,this.T.shouldDraw=!0,this.saveState(),this.loadPreviousState();var d=getRandomInt(0,255),e={inputs:[{element:this.Tld,value:0,valueType:this.valueType.CONSTANT}],outputs:[{element:this.T,dataOperation:"oldT"}]};return c.push(e),e={inputs:[{element:this.Tld,value:1,valueType:this.valueType.CONSTANT}],outputs:[{element:this.T,dataOperation:d+""}]},c.push(e),b.push(c),$("#"+this.id+" .problem1.assign1").text("T = "+d+";"),this.draw(),{solutions:b}}if(1===a){var b=[];this.Dgt.shouldDraw=!1,this.Ts.shouldDraw=!0,this.Tld.shouldDraw=!0,this.clock.shouldDraw=!0,this.D.shouldDraw=!1,this.T.shouldDraw=!0,this.saveState(),this.loadPreviousState();var f=getRandomInt(0,255),g=getRandomInt(0,255),c=[],e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT}],outputs:[{element:this.T,dataOperation:f+""}]};return c.push(e),e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT}],outputs:[{element:this.T,dataOperation:"oldT"}]},c.push(e),e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT}],outputs:[{element:this.T,dataOperation:g+""}]},c.push(e),e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT}],outputs:[{element:this.T,dataOperation:"oldT"}]},c.push(e),b.push(c),c=[],e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT}],outputs:[{element:this.T,dataOperation:f+""}]},c.push(e),e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT}],outputs:[{element:this.T,dataOperation:"oldT"}]},c.push(e),e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT}],outputs:[{element:this.T,dataOperation:g+""}]},c.push(e),e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT}],outputs:[{element:this.T,dataOperation:"oldT"}]},c.push(e),b.push(c),$("#"+this.id+" .problem2.assign1").text("T = "+f+";"),$("#"+this.id+" .problem2.assign2").text("T = "+g+";"),this.draw(),{solutions:b}}if(2===a){this.Dgt.shouldDraw=!1,this.Ts.shouldDraw=!0,this.Tld.shouldDraw=!0,this.clock.shouldDraw=!0,this.D.shouldDraw=!0,this.T.shouldDraw=!0,this.saveState(),this.loadPreviousState();var d=getRandomInt(0,255),h=d,b=[],c=[],e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:"D"}]};return c.push(e),e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:"oldT"}]},c.push(e),e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:h+""}]},c.push(e),e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:"oldT"}]},c.push(e),b.push(c),c=[],e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:"D"}]},c.push(e),e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:"oldT"}]},c.push(e),e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT
},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:h+""}]},c.push(e),e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:"oldT"}]},c.push(e),b.push(c),$("#"+this.id+" .problem3.assign1").text("T = D;"),$("#"+this.id+" .problem3.assign2").text("T = D;"),$("#"+this.id+" .problem3.assign3").text("T = "+h+";"),$("#"+this.id+" .problem3.assign4").text("T = "+h+";"),this.draw(),{solutions:b}}if(3===a){this.Dgt.shouldDraw=!1,this.Ts.shouldDraw=!0,this.Tld.shouldDraw=!0,this.clock.shouldDraw=!0,this.D.shouldDraw=!0,this.T.shouldDraw=!0,this.saveState(),this.loadPreviousState();var d=getRandomInt(1,9),h="D + "+d,b=[],c=[],e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:"D"}]};return c.push(e),e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:"oldT"}]},c.push(e),e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:h}]},c.push(e),e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:"oldT"}]},c.push(e),b.push(c),c=[],e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:"D"}]},c.push(e),e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:"oldT"}]},c.push(e),e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:h}]},c.push(e),e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8}],outputs:[{element:this.T,dataOperation:"oldT"}]},c.push(e),b.push(c),$("#"+this.id+" .problem4.assign1").text("T = D;"),$("#"+this.id+" .problem4.assign2").text("T = D;"),$("#"+this.id+" .problem4.assign3").text("T = "+h+";"),$("#"+this.id+" .problem4.assign4").text("T = "+h+";"),this.draw(),{solutions:b}}if(4===a){this.Dgt.shouldDraw=!0,this.Ts.shouldDraw=!0,this.Tld.shouldDraw=!0,this.clock.shouldDraw=!0,this.D.shouldDraw=!0,this.T.shouldDraw=!0;var i=getRandomInt(1,254),j=[">","<","=="],k={">":"gt","<":"lt","==":"eq"},l=j[getRandomInt(0,2)];this.Dgt.name="D_"+k[l],this.saveState(),this.loadPreviousState();var f=getRandomInt(0,99),g=getRandomInt(0,99),m="D "+l+" "+i,b=[],c=[],e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8,comparisonOperation:l,comparisonValue:i}],outputs:[{element:this.T,dataOperation:f+""},{element:this.Dgt,dataOperation:m}]};return c.push(e),e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8,comparisonOperation:l,comparisonValue:i}],outputs:[{element:this.T,dataOperation:"oldT"},{element:this.Dgt,dataOperation:m}]},c.push(e),e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8,comparisonOperation:l,comparisonValue:i}],outputs:[{element:this.T,dataOperation:g+""},{element:this.Dgt,dataOperation:m}]},c.push(e),e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8,comparisonOperation:l,comparisonValue:i}],outputs:[{element:this.T,dataOperation:"oldT"},{element:this.Dgt,dataOperation:m}]},c.push(e),b.push(c),c=[],e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8,comparisonOperation:l,comparisonValue:i}],outputs:[{element:this.T,dataOperation:f+""},{element:this.Dgt,dataOperation:m}]},c.push(e),e={inputs:[{element:this.Ts,value:1,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8,comparisonOperation:l,comparisonValue:i}],outputs:[{element:this.T,dataOperation:"oldT"},{element:this.Dgt,dataOperation:m}]},c.push(e),e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:1,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8,comparisonOperation:l,comparisonValue:i}],outputs:[{element:this.T,dataOperation:g+""},{element:this.Dgt,dataOperation:m}]},c.push(e),e={inputs:[{element:this.Ts,value:0,valueType:this.valueType.CONSTANT},{element:this.Tld,value:0,valueType:this.valueType.CONSTANT},{element:this.D,valueType:this.valueType.RANDOM8,comparisonOperation:l,comparisonValue:i}],outputs:[{element:this.T,dataOperation:"oldT"},{element:this.Dgt,dataOperation:m}]},c.push(e),b.push(c),$("#"+this.id+" .problem5.assign1").text("T = "+f+";"),$("#"+this.id+" .problem5.assign2").text("T = "+g+";"),$("#"+this.id+" .problem5.condition1").text("!("+m+")"),$("#"+this.id+" .problem5.condition2").text(m),$("#"+this.id+" .problem5.condition3").text("("+m+") || !b"),$("#"+this.id+" .problem5.condition4").text("!(("+m+") || !b)"),this.draw(),{solutions:b}}},this.initZyDigSim=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(a,b){this.undoRedoIndex=0,this.undoRedoStack=new Array,this.maxSize=a,this.reset(b)}function p(){if(NAMES[Element.IN]=["a","b","c","d","e","f","g","h","i","j"],NAMES[Element.OUT]=["z","y","x","w","v","u","t","s","r","q"],NAMES[Component.ADDER]=["Adder1","Adder2","Adder3","Adder4","Adder5","Adder6","Adder7","Adder8","Adder9","Adder10"],NAMES[Component.MUX]=["Mux1","Mux2","Mux3","Mux4","Mux5","Mux6","Mux7","Mux8","Mux9","Mux10"],NAMES[Component.COMPARATOR]=["Comparator1","Comparator2","Comparator3","Comparator4","Comparator5","Comparator6","Comparator7","Comparator8","Comparator9","Comparator10"],NAMES[Component.LOAD_REGISTER]=["Load register1","Load register2","Load register3","Load register4","Load register5","Load register6","Load register7","Load register8","Load register9","Load register10"],NAMES[Component.IN]=["A","B","C","D","E","F","G","H","I","J"],NAMES[Component.OUT]=["Z","Y","X","W","V","U","T","S","R","Q"],d="undefined"!=typeof d?d:!0,e="undefined"!=typeof e?e:!0,f="undefined"!=typeof f?f:!0,k="undefined"!=typeof k?k:!0,l="undefined"!=typeof l?l:!1,g="undefined"!=typeof g?g:DEFAULT_WIDTH,h="undefined"!=typeof h?h:DEFAULT_HEIGHT,m="undefined"!=typeof m?m:!1,n="undefined"!=typeof n?n:!0,ia=$("#logicCanvas_"+a)[0],l?$("#resetButton_"+a).hide():$("#toolBoxCanvas_"+a).addClass("gate-pointer"),g=e&&f?680>g?680:g:e?675>g?675:g:250>g?250:g,j&&(h=315>h?315:h),f||($("#toolBoxCanvas_"+a).hide(),$("#"+a+" .toolbox-container").css("width","0").hide()),$("#logicCanvasContainer_"+a).width(g),$("#logicCanvasContainer_"+a).height(h),$("#"+a+" .bottom-buttons").width($("#"+a+" .bottom-buttons").width()-(DEFAULT_WIDTH-g)+50),$("#"+a+" .middle-container").width(g+$("#"+a+" .toolbox-container").width()+15),ja=ia.getContext("2d"),la=new Array,oa=$("#toolBoxCanvas_"+a)[0],pa=oa.getContext("2d"),qa=new Array,Ea=!1,Fa=[],Ga=null,inputNameIndex=0,outputNameIndex=0,Ma=-1,Ja=d,Ka=!0,Oa=!1,Da={x:$("#logicCanvasContainer_"+a).scrollLeft(),y:$("#logicCanvasContainer_"+a).scrollTop()},"undefined"==typeof ZyDigSim.imageAssets?V():ZyDigSim.imagesHaveLoaded?(U(),T()):ZyDigSim.imagesHaveLoadedCallbacks.push(function(){U(),T(),_()}),d||($("#deleteSelectedItemsButton_"+a).hide(),$("#undoButton_"+a).hide()),ra=!1,va={elementIndex:-1,wireIndex:-1,isOutput:!0},sa=null,xa=0,na=new Element(0,0,qa[0],null,0,"none"),e||($("#JSONLoadSave_"+a).hide(),$("#"+a+" .bottom-buttons").hide()),k||$("#logicCanvasContainer_"+a).css("overflow","hidden"),$("#logicCanvas_"+a).on("touchmove mousemove",function(b){var c=q(b),d=c.x+$("#logicCanvasContainer_"+a).scrollLeft()-$("#logicCanvasContainer_"+a).offset().left,e=c.y+$("#logicCanvasContainer_"+a).scrollTop()-$("#logicCanvasContainer_"+a).offset().top;L(d,e)}),$("#logicCanvas_"+a).on("touchstart mousedown",function(b){Pa.blur();var c=q(b),d=c.x+$("#logicCanvasContainer_"+a).scrollLeft()-$("#logicCanvasContainer_"+a).offset().left,e=c.y+$("#logicCanvasContainer_"+a).scrollTop()-$("#logicCanvasContainer_"+a).offset().top;b.preventDefault(),H(d,e,b.which)}),$("#logicCanvas_"+a).on("touchend mouseup",function(b){var c=q(b),d=c.x+$("#logicCanvasContainer_"+a).scrollLeft()-$("#logicCanvasContainer_"+a).offset().left,e=c.y+$("#logicCanvasContainer_"+a).scrollTop()-$("#logicCanvasContainer_"+a).offset().top;I(d,e)}),$("#toolBoxCanvas_"+a).on("touchend mouseup",function(b){Pa.blur(),ra=!1;var c=q(b),d=c.x-$("#toolBoxCanvas_"+a).offset().left,e=c.y-$("#toolBoxCanvas_"+a).offset().top;if(1==b.which&&Ja)for(var f=0;f<qa.length;f++){var g=qa[f];if(fa(d,e,g.x,g.y,g.width,g.height)){if(na.elementType=qa[f].elementType,-1==qa[f].elementType.indexOf("component")&&(qa[f].operation==ELEMENT_FUNCTIONS.OUT?na.img=ZyDigSim.imageAssets.undefinedImg:qa[f].operation==ELEMENT_FUNCTIONS.IN?na.img=ZyDigSim.imageAssets.zeroImg:na.img=qa[f].img,na.operation=qa[f].operation),na.maxInput=qa[f].maxInput,na.x=5*Math.round((3*$("#logicCanvasContainer_"+a).width()/4+(Math.random()*($("#logicCanvasContainer_"+a).width()/4)-$("#logicCanvasContainer_"+a).width()/4)+$("#logicCanvasContainer_"+a).scrollLeft())/5),na.y=5*Math.round(($("#logicCanvasContainer_"+a).height()/4+(Math.random()*($("#logicCanvasContainer_"+a).height()/4)-$("#logicCanvasContainer_"+a).height()/4)+$("#logicCanvasContainer_"+a).scrollTop())/5),-1==qa[f].elementType.indexOf("component")){if(la.push(new Element(na.x,na.y,na.img,na.operation,na.maxInput,na.elementType,D(na.elementType),!1)),na.operation==ELEMENT_FUNCTIONS.LABEL){var h=la[la.length-1];h.value="Text",E(h)}}else la.push(new Component(na.x,na.y,na.elementType,qa[f].bitWidth,!1)),NAMES[la[la.length-1].elementType]&&(la[la.length-1].name=D(la[la.length-1].elementType));if(na.img=qa[0].img,na.maxInput=qa[0].maxInput,na.operation=qa[0].operation,na.elementType="none",xa=0,sa=[la[la.length-1]],$("#deleteSelectedItemsButton_"+a).prop("disabled",!1),$("#deleteSelectedItemsButton_"+a).removeClass("disabled"),Ca.pushState(ea()),_(),sa[0].elementType==Component.CONSTANT){var i=prompt("Enter value",0);null!=i&&(sa[0].value=parseInt(i,10))}Oa=!0,setTimeout(function(){Oa=!1,N(),setTimeout(function(){Oa=!0,N(),setTimeout(function(){Oa=!1,N()},250)},250)},250);break}}}),$(document).on("touchend mouseup",function(a){ra=!1,za=null}),$(document).on("mousedown touchstart",function(b){var c=document.getElementById(a);Ea=c&&$.contains(c,b.target)?!0:!1}),$(document).keyup(function(a){return a.preventDefault(),Ja&&Ea?(46==a.keyCode&&(aa(),xa=0),void(90==a.keyCode&&a.ctrlKey&&a.shiftKey?(da(Ca.redo()),_()):90==a.keyCode&&a.ctrlKey&&s())):!1}),$("#undoButton_"+a).click(function(){s()}),$("#logicCanvasContainer_"+a).scroll(function(a){if(k){Pa.blur();for(var b=0;b<la.length;b++)la[b].operation==ELEMENT_FUNCTIONS.LABEL&&F(la[b])}}),$("#resetButton_"+a).click(y),$("#deleteSelectedItemsButton_"+a).click(aa),$("#importBtn_"+a).click(function(){ba()}),$("#exportBtn_"+a).click(function(){ca()}),$("#exampleDrop_"+a).change(function(){M(),Ca.pushState(ea())}),i?(da(i),Ha=i):(M(),Ha=ea()),$("#deleteSelectedItemsButton_"+a).prop("disabled",!0),$("#deleteSelectedItemsButton_"+a).addClass("disabled"),Pa=$("#"+a+" .component-input"),Pa.hide(),Ia=J(),Ca=new o(5e4,ea()),_(),l?m?($("#progressionImage1_"+a)[0].src=b.getResourceURL("q1.png",c),$("#progressionImage2_"+a)[0].src=b.getResourceURL("q2.png",c),$("#progressionImage3_"+a)[0].src=b.getResourceURL("q3.png",c),$("#progressionImage4_"+a)[0].src=b.getResourceURL("q4.png",c),$("#progressionImage5_"+a)[0].src=b.getResourceURL("q5.png",c),$("#"+Qa.id).width("740px"),$("#progressionImage1_"+a).hide(),$("#progressionImage2_"+a).hide(),$("#progressionImage3_"+a).hide(),$("#progressionImage4_"+a).hide(),$("#progressionImage5_"+a).hide(),$("#progressionImageContainer_"+a).append("<div class='generated-text problem1 assign1'>T = 6;</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem2 assign1'>T = 6;</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem2 assign2'>T = 12;</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem3 assign1'>T = D;</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem3 assign2'>T = D;</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem3 assign3'>T = 5;</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem3 assign4'>T = 5;</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem4 assign1'>T = D;</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem4 assign2'>T = D;</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem4 assign3'>T = D + 5;</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem4 assign4'>T = D + 5;</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem5 assign1'>T = 0;</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem5 assign2'>T = 9;</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem5 condition1'>!(D &gt; 6)</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem5 condition2'>D &gt; 6</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem5 condition3'>(D &gt; 6) || !b</div>"),$("#progressionImageContainer_"+a).append("<div class='generated-text problem5 condition4'>!((D &gt; 6) || !b)</div>"),$("#"+a+" .generated-text").hide()):($("#"+Qa.id).width("712px"),$("#progressionImageContainer_"+a).hide()):$("#progressionImageContainer_"+a).hide(),m){$("#legendCanvas_"+a).css("left",$("#legendCanvas_"+a).position().left+$("#logicCanvasContainer_"+a).width()-$("#legendCanvas_"+a).width()-Ia.width);var p=$("#legendCanvas_"+a)[0],z=p.getContext("2d");z.fillStyle="white",z.fillRect(0,0,p.width,p.height),z.fillStyle="black",z.font="12px Helvetica",z.textBaseline="middle",z.beginPath(),z.fillText("Legend:",5,p.height/2),z.moveTo(10+z.measureText("Legend:").width,p.height/2+QUARTER_WIRE_LENGTH),z.lineTo(10+HALF_WIRE_LENGTH+z.measureText("Legend:").width,p.height/2-QUARTER_WIRE_LENGTH),z.fillText("8 bits",p.width/2+WIRE_LENGTH,p.height/2),z.stroke()}else $("#legendCanvas_"+a).hide();$("#undoButton_"+a).prop("disabled",!0),$("#undoButton_"+a).addClass("disabled"),Qa.buildCompleteEquation=C,Qa.reset=y,Qa.setAllowedToEdit=A,Qa.getElementByName=v,Qa.getElementThatContains=w,Qa.draw=N,Qa.getElementByType=x,Qa.saveState=u,Qa.loadPreviousState=t,Qa.resetUndoRedoStack=r,Qa.verifyUpdate=function(){xa=0,_()}}function q(a){return-1!=a.type.indexOf("touch")?a.originalEvent.touches.length>0?{x:a.originalEvent.touches[0].pageX,y:a.originalEvent.touches[0].pageY}:{x:a.originalEvent.changedTouches[0].pageX,y:a.originalEvent.changedTouches[0].pageY}:{x:a.pageX,y:a.pageY}}function r(){Ca.reset(ea())}function s(){da(Ca.undo()),_(),m&&l&&Qa.loadGates()}function t(){Ca.undo()}function u(){Ca.pushState(ea())}function v(a){for(var b=0;b<la.length;b++)if(la[b].name==a)return la[b];return null}function w(a){for(var b=0;b<la.length;b++)if(-1!==la[b].name.indexOf(a))return la[b];return null}function x(a){elementsWithType=[];for(var b=0;b<la.length;b++)la[b].elementType==a&&elementsWithType.push(la[b]);return elementsWithType}function y(){$(this).blur(),da(Ha),Ca.reset(Ha),sa=null,Fa=[],va={elementIndex:-1,wireIndex:-1,isOutput:!0},z()}function z(){(null!=sa&&0!=sa.length||0!=Fa.length)&&Ja?($("#deleteSelectedItemsButton_"+a).prop("disabled",!1),$("#deleteSelectedItemsButton_"+a).removeClass("disabled")):($("#deleteSelectedItemsButton_"+a).prop("disabled",!0),$("#deleteSelectedItemsButton_"+a).addClass("disabled"))}function A(b){Ja=b,Ka=b,b?($("#toolBoxCanvas_"+a).addClass("gate-pointer"),Ca.empty()||($("#undoButton_"+a).prop("disabled",!1),$("#undoButton_"+a).removeClass("disabled")),l&&Qa.$middleContainerCover.removeClass("active")):($("#toolBoxCanvas_"+a).removeClass("gate-pointer"),$("#undoButton_"+a).prop("disabled",!0),$("#undoButton_"+a).addClass("disabled"),l&&Qa.$middleContainerCover.addClass("active"))}function B(a,b){if(!a)return"";if(a.elementType===Element.AND){if(2!==a.inputs.length||null===a.inputs[0]||null===a.inputs[1])return"";var c=B(a.inputs[0],b),d=B(a.inputs[1],b),e="";"proposition"===b&&(e=Qa.discreteMathUtilities.andSymbol);var f=c+e+d;return"("+f+")"}if(a.elementType===Element.OR){if(2!==a.inputs.length||null===a.inputs[0]||null===a.inputs[1])return"";var c=B(a.inputs[0],b),d=B(a.inputs[1],b),e=" + ";"proposition"===b&&(e=Qa.discreteMathUtilities.orSymbol);var f=c+e+d;return"("+f+")"}if(a.elementType===Element.NOT){if(1!==a.inputs.length||null===a.inputs[0])return"";var f=B(a.inputs[0],b);switch(a.inputs[0].elementType!==Element.IN&&(f="("+f+")"),b){case"digitalDesign":f+="'";break;case"proposition":f=Qa.discreteMathUtilities.notSymbol+f;break;case"latex":f="\\overline{"+f+"}"}return f}return a.elementType==Element.IN?a.name:void 0}function C(a){for(var b=null,c=0;c<la.length;c++)la[c].elementType==Element.OUT&&(b=la[c]);var d="";if(b){var e=b.inputs[0];d=B(e,a)}return d}function D(a){if(!NAMES[a])return"";for(var b="",c={},d=0;d<la.length;d++)la[d].elementType==a&&(c[la[d].name]=1);for(var d=0;d<NAMES[a].length;d++)if(!(NAMES[a][d]in c)){b=NAMES[a][d];break}return b}function E(b){var c=G(a);b.labelID=c,$("#"+a).append("<div id='label"+c+"_"+a+"' contenteditable='true' class='label'>"+b.value+"</div>"),$("#label"+c+"_"+a).mousemove(function(b){var c=q(b),e=c.x+$("#logicCanvasContainer_"+a).scrollLeft()-$("#logicCanvasContainer_"+a).offset().left,f=c.y+$("#logicCanvasContainer_"+a).scrollTop()-$("#logicCanvasContainer_"+a).offset().top;L(e,f),d||(b.preventDefault(),$(this).blur())}),$("#label"+c+"_"+a).mousedown(function(b){var c=q(b),e=c.x+$("#logicCanvasContainer_"+a).scrollLeft()-$("#logicCanvasContainer_"+a).offset().left,f=c.y+$("#logicCanvasContainer_"+a).scrollTop()-$("#logicCanvasContainer_"+a).offset().top;H(e,f,b.which),d||(b.preventDefault(),$(this).blur())}),$("#label"+c+"_"+a).mouseup(function(b){var c=q(b),e=c.x+$("#logicCanvasContainer_"+a).scrollLeft()-$("#logicCanvasContainer_"+a).offset().left,f=c.y+$("#logicCanvasContainer_"+a).scrollTop()-$("#logicCanvasContainer_"+a).offset().top;I(e,f),d||(b.preventDefault(),$(this).blur())}),$("#label"+c+"_"+a).keydown(function(a){d&&(b.value=this.value,b.width=$(this).width(),b.height=$(this).height())}),F(b),b.width=$("#label"+c+"_"+a).width(),b.height=$("#label"+c+"_"+a).height()}function F(b){var c=b.x-$("#logicCanvasContainer_"+a).scrollLeft()+$("#"+a+" .middle-container").position().left,d=b.y-$("#logicCanvasContainer_"+a).scrollTop()+$("#"+a+" .middle-container").position().top;$("#label"+b.labelID+"_"+a).css("left",c),$("#label"+b.labelID+"_"+a).css("top",d),d>$("#logicCanvasContainer_"+a).position().top+$("#logicCanvasContainer_"+a).height()||c>$("#logicCanvasContainer_"+a).position().left+$("#logicCanvasContainer_"+a).width()||d<$("#logicCanvasContainer_"+a).position().top||c<$("#logicCanvasContainer_"+a).position().left?$("#label"+b.labelID+"_"+a).hide():$("#label"+b.labelID+"_"+a).show()}function G(a){var b=0;return $("#"+a+" .label").each(function(a,c){var d=/\d+/,e=parseFloat($(c).attr("id").match(d));e>=b&&(b=e+1)}),b}function H(b,c,e){if((1===e||0===e)&&Ka){if(ua=setTimeout(function(){ra=!0},100),null!=sa&&1==sa.length&&(sa=null),null==sa||sa.length<=1){va={elementIndex:-1,wireIndex:-1,isOutput:!0},Ba=d?null!=Ga&&W(b,c)==Ga?!0:!1:!0,$("#"+a+" .label").blur(),sa=new Array;for(var f=null,g=null,h=la.length-1;h>=0;h--)f=W(b,c,h),null==f||d||f.elementType===Element.IN||(f=null),null==f&&(va=X(b,c,h),-1!=va.elementIndex&&(null==g?g=va:(va.isOutput&&!g.isOutput||va.isOutput&&g.isOutput&&va.elementIndex>g.elementIndex||!va.isOutput&&!g.isOutput&&va.elementIndex>g.elementIndex)&&(g=va)));null!=g&&(va=g),null!=f&&(va={elementIndex:-1,wireIndex:-1,isOutput:!0}),sa.push(f),null!=sa[0]?(Fa=[],Ga=sa[0],ta={x:sa[0].x,y:sa[0].y}):ta=null,null==sa[0]&&(sa=null)}null==sa&&(Fa.length>0&&null!=sa&&sa.length>1||(-1==va.elementIndex&&(va=X(b,c)),d||(va={elementIndex:-1,wireIndex:-1,isOutput:!0}),wa=[b,c],Fa=-1==va.elementIndex||va.isOutput||-1==la.indexOf(la[va.elementIndex].inputs[va.wireIndex])?[]:[va],!va.isOutput&&null!=la[va.elementIndex].inputs[va.wireIndex]||!Ja||null!=sa&&sa.length>1||-1==va.elementIndex?va={elementIndex:-1,wireIndex:-1,isOutput:!0}:Fa=[va])),za=-1==va.elementIndex&&null==sa&&0==Fa.length?{origin:{X:b,Y:c},end:{X:b,Y:c}}:null,Aa={X:b,Y:c}}Ma=-1,z(),clearInterval(ka),ka=0,ka=setInterval(_,DRAW_INTERVAL)}function I(b,c){if(null!=sa&&Ja&&ra){for(var e=0;e<sa.length;e++)sa[e].moveTo(Math.round(sa[e].x/CANVAS_GRANULARITY)*CANVAS_GRANULARITY,Math.round(sa[e].y/CANVAS_GRANULARITY)*CANVAS_GRANULARITY),sa[e].elementType==Element.LABEL&&F(sa[e]);Ca.pushState(ea())}if(null!=ta&&null!=sa&&null!=sa[0]&&ta.x==sa[0].x&&ta.y==sa[0].y&&(ra=!1),ra&&-1!=va.elementIndex)-1!==Ma&&(va.isOutput?va.isOutput&&(la[va.elementIndex].connectOutput(la[Ma],Na,va.wireIndex),la[Ma].connectInput(la[va.elementIndex],Na,va.wireIndex)):(la[Ma].connectOutput(la[va.elementIndex],va.wireIndex,Na),la[va.elementIndex].connectInput(la[Ma],va.wireIndex,Na)),xa=0,Ca.pushState(ea())),Fa=[];else if(ra&&null==sa&&d&&0==Fa.length){var f={x:0,y:0,width:0,height:0};za.origin.X>za.end.X?(f.x=za.end.X,f.width=za.origin.X-za.end.X):(f.x=za.origin.X,f.width=za.end.X-za.origin.X),za.origin.Y>za.end.Y?(f.y=za.end.Y,f.height=za.origin.Y-za.end.Y):(f.y=za.origin.Y,f.height=za.end.Y-za.origin.Y),Ba=!1,sa=[],$("#"+a+" .label").blur();for(var e=0;e<la.length;e++)la[e].shouldDraw&&ga(la[e].x,la[e].y,la[e].width,la[e].height,f.x,f.y,f.width,f.height)&&sa.push(la[e]);Y(f.x,f.y,f.width,f.height),ta=sa.length>0?{x:sa[0].x,y:sa[0].y}:null}else if(!ra){var g=W(b,c);if(null!=g&&(g.elementType==Element.IN||g.elementType==Component.IN)&&Ba&&Ka){if(Ba=!1,g.elementType==Element.IN)g.value==ELEMENT_VALUES.TRUE?g.value=ELEMENT_VALUES.FALSE:g.value=ELEMENT_VALUES.TRUE;else if(g.elementType==Component.IN){var h,i=g.x-$("#logicCanvasContainer_"+a).scrollLeft(),j=g.y-$("#logicCanvasContainer_"+a).scrollTop();Pa.css("left",i),Pa.css("top",j),Pa.show(),Pa.val(g.value),Pa.select(),Pa.blur(function(){h=$(this).val(),null==h||isNaN(parseInt(h,10))||(g.value=parseInt(h,10)),Pa.hide(),Pa.unbind("blur"),Pa.unbind("change"),xa=0,Ca.pushState(ea()),_()}),Pa.change(function(){h=$(this).val(),null==h||isNaN(parseInt(h,10))||(g.value=parseInt(h,10)),xa=0,_()})}xa=0,Ca.pushState(ea())}else if(null!=g){if(null!=sa&&sa.length>1){for(var k=!1,e=0;e<sa.length;e++)la.indexOf(sa[e])==la.indexOf(g)&&(k=!0);k||(sa=[g],Fa=[])}}else null!=sa&&sa.length>1?(sa=null,Fa=[]):null==g&&(sa=null,1!=Fa.length||(Fa[0].isOutput||la[Fa[0].elementIndex].inputs[Fa[0].wireIndex])&&Fa[0].onlyForSelection||(Fa=[]))}Aa={X:b,Y:c},za=null,Ma=-1,clearTimeout(ua),wa=[0,0],va={elementIndex:-1,wireIndex:-1,isOutput:!0},ra=!1,z(),clearInterval(ka),ka=0,_()}function J(){var a=document.createElement("div");a.style.visibility="hidden",a.style.width="100px",a.style.height="100px",a.style.msOverflowStyle="scrollbar",document.body.appendChild(a);var b=a.offsetWidth,c=a.offsetHeight;a.style.overflow="scroll";var d=document.createElement("div");d.style.width="100%",d.style.height="100%",a.appendChild(d);var e=d.offsetWidth,f=d.offsetHeight;return a.parentNode.removeChild(a),{width:b-e,height:c-f}}function K(b,c,d){var e,f,g,h;b.x,b.y;e=$("#logicCanvasContainer_"+a).scrollLeft(),f=$("#logicCanvasContainer_"+a).scrollTop(),g=$("#logicCanvasContainer_"+a).scrollLeft()+$("#logicCanvasContainer_"+a).width(),h=$("#logicCanvasContainer_"+a).scrollTop()+$("#logicCanvasContainer_"+a).height(),c+b.width+Ia.width>=g||e>=c||b.moveTo(c,b.y),d+b.height+Ia.height>=h||f>=d||b.moveTo(b.x,d)}function L(a,b){if(ra&&null!=sa&&sa.length>0&&Ja)if(1==sa.length)K(sa[0],a-sa[0].width/2,b-sa[0].height/2),sa[0].elementType==Element.LABEL&&F(sa[0]);else for(var c=0;c<sa.length;c++)K(sa[c],sa[c].x+a-Aa.X,sa[c].y+b-Aa.Y),sa[c].elementType==Element.LABEL&&F(sa[c]);else ra&&null!=za&&Ja?(za.end.X=a,za.end.Y=b):ra&&Ja&&(wa=[a,b],-1!=va.elementIndex&&R());Aa={X:a,Y:b},ka||(ka=setInterval(_,DRAW_INTERVAL))}function M(){var b="";switch($("#exampleDrop_"+a)[0].selectedIndex){case 0:b=m?'{"elements":[{"id":"element_0","type":"constant-component","x":265,"y":180,"maxInput":0,"currentVal":1,"name":"Constant","bitWidth":8},{"id":"element_1","type":"in-component","x":155,"y":35,"maxInput":0,"currentVal":5,"name":"A","bitWidth":8},{"id":"element_2","type":"in-component","x":220,"y":35,"maxInput":0,"currentVal":17,"name":"B","bitWidth":8},{"id":"element_3","type":"out-component","x":240,"y":385,"maxInput":1,"currentVal":6,"name":"Z","bitWidth":8},{"id":"element_4","type":"mux-component","x":160,"y":140,"maxInput":3,"currentVal":0,"name":"Mux1","bitWidth":8},{"id":"element_5","type":"adder-component","x":205,"y":275,"maxInput":2,"currentVal":6,"name":"Adder1","bitWidth":8},{"id":"element_6","type":"in","x":75,"y":145,"maxInput":0,"currentVal":0,"name":"a","bitWidth":1}],"connections":[{"id":"element_0_1","src":"element_0","dst":"element_5","portIndex":0},{"id":"element_0_0","src":"element_1","dst":"element_4","portIndex":0},{"id":"element_0_1","src":"element_2","dst":"element_4","portIndex":0},{"id":"element_0_0","src":"element_4","dst":"element_5","portIndex":0},{"id":"element_0_0","src":"element_5","dst":"element_3","portIndex":0},{"id":"element_0_2","src":"element_6","dst":"element_4","portIndex":0}]}':'{"elements":[{"id":"element_0","type":"not","x":200,"y":115,"maxInput":1,"currentVal":1,"name":""},{"id":"element_1","type":"in","x":60,"y":120,"maxInput":0,"currentVal":0,"name":""},{"id":"element_2","type":"and","x":310,"y":115,"maxInput":2,"currentVal":0,"name":""},{"id":"element_3","type":"and","x":270,"y":200,"maxInput":2,"currentVal":0,"name":""},{"id":"element_4","type":"in","x":60,"y":210,"maxInput":0,"currentVal":0,"name":""},{"id":"element_5","type":"out","x":525,"y":140,"maxInput":1,"currentVal":1,"name":""},{"id":"element_6","type":"nor","x":405,"y":130,"maxInput":2,"currentVal":1,"name":""},{"id":"element_7","type":"nor","x":405,"y":200,"maxInput":2,"currentVal":0,"name":""},{"id":"element_8","type":"label","x":20,"y":215,"maxInput":0,"currentVal":"E","name":""},{"id":"element_9","type":"label","x":20,"y":125,"maxInput":0,"currentVal":"D","name":""},{"id":"element_10","type":"label","x":590,"y":145,"maxInput":0,"currentVal":"Q","name":""}],"connections":[{"id":"element_0_0","src":"element_1","dst":"element_0"},{"id":"element_2_0","src":"element_0","dst":"element_2"},{"id":"element_2_1","src":"element_4","dst":"element_2"},{"id":"element_3_0","src":"element_4","dst":"element_3"},{"id":"element_3_1","src":"element_1","dst":"element_3"},{"id":"element_5_0","src":"element_6","dst":"element_5"},{"id":"element_6_0","src":"element_2","dst":"element_6"},{"id":"element_6_1","src":"element_7","dst":"element_6"},{"id":"element_7_0","src":"element_6","dst":"element_7"},{"id":"element_7_1","src":"element_3","dst":"element_7"}]}';break;case 1:b='{"elements":[{"id":"element_0","type":"and","x":320,"y":135,"maxInput":2,"currentVal":0,"name":""},{"id":"element_1","type":"xor","x":320,"y":230,"maxInput":2,"currentVal":1,"name":""},{"id":"element_2","type":"in","x":135,"y":145,"maxInput":0,"currentVal":1,"name":""},{"id":"element_3","type":"in","x":145,"y":250,"maxInput":0,"currentVal":0,"name":""},{"id":"element_4","type":"out","x":420,"y":155,"maxInput":1,"currentVal":0,"name":""},{"id":"element_5","type":"out","x":420,"y":245,"maxInput":1,"currentVal":1,"name":""},{"id":"element_6","type":"label","x":500,"y":250,"maxInput":0,"currentVal":"Sum","name":""},{"id":"element_7","type":"label","x":500,"y":160,"maxInput":0,"currentVal":"Carry","name":""},{"id":"element_8","type":"label","x":80,"y":150,"maxInput":0,"currentVal":"A","name":""},{"id":"element_9","type":"label","x":75,"y":255,"maxInput":0,"currentVal":"B","name":""}],"connections":[{"id":"element_0_0","src":"element_2","dst":"element_0"},{"id":"element_0_1","src":"element_3","dst":"element_0"},{"id":"element_1_0","src":"element_2","dst":"element_1"},{"id":"element_1_1","src":"element_3","dst":"element_1"},{"id":"element_4_0","src":"element_0","dst":"element_4"},{"id":"element_5_0","src":"element_1","dst":"element_5"}]}';break;case 2:b='{"elements":[{"id":"element_0","type":"and","x":395,"y":70,"maxInput":2,"currentVal":0,"name":""},{"id":"element_1","type":"and","x":395,"y":295,"maxInput":2,"currentVal":1,"name":""},{"id":"element_2","type":"and","x":395,"y":220,"maxInput":2,"currentVal":0,"name":""},{"id":"element_3","type":"and","x":395,"y":145,"maxInput":2,"currentVal":0,"name":""},{"id":"element_4","type":"out","x":490,"y":310,"maxInput":1,"currentVal":1,"name":""},{"id":"element_5","type":"out","x":490,"y":160,"maxInput":1,"currentVal":0,"name":""},{"id":"element_6","type":"out","x":490,"y":235,"maxInput":1,"currentVal":0,"name":""},{"id":"element_7","type":"out","x":490,"y":85,"maxInput":1,"currentVal":0,"name":""},{"id":"element_8","type":"not","x":205,"y":70,"maxInput":1,"currentVal":0,"name":""},{"id":"element_9","type":"not","x":205,"y":125,"maxInput":1,"currentVal":0,"name":""},{"id":"element_10","type":"in","x":45,"y":130,"maxInput":0,"currentVal":1,"name":""},{"id":"element_11","type":"in","x":45,"y":80,"maxInput":0,"currentVal":1,"name":""},{"id":"element_12","type":"label","x":15,"y":80,"maxInput":0,"currentVal":"A0","name":""},{"id":"element_13","type":"label","x":15,"y":130,"maxInput":0,"currentVal":"A1","name":""},{"id":"element_14","type":"label","x":560,"y":90,"maxInput":0,"currentVal":"D0","name":""},{"id":"element_15","type":"label","x":560,"y":165,"maxInput":0,"currentVal":"D1","name":""},{"id":"element_16","type":"label","x":560,"y":240,"maxInput":0,"currentVal":"D2","name":""},{"id":"element_17","type":"label","x":560,"y":315,"maxInput":0,"currentVal":"D3","name":""}],"connections":[{"id":"element_0_0","src":"element_8","dst":"element_0"},{"id":"element_0_1","src":"element_9","dst":"element_0"},{"id":"element_1_0","src":"element_10","dst":"element_1"},{"id":"element_1_1","src":"element_11","dst":"element_1"},{"id":"element_2_0","src":"element_10","dst":"element_2"},{"id":"element_2_1","src":"element_8","dst":"element_2"},{"id":"element_3_0","src":"element_11","dst":"element_3"},{"id":"element_3_1","src":"element_9","dst":"element_3"},{"id":"element_4_0","src":"element_1","dst":"element_4"},{"id":"element_5_0","src":"element_3","dst":"element_5"},{"id":"element_6_0","src":"element_2","dst":"element_6"},{"id":"element_7_0","src":"element_0","dst":"element_7"},{"id":"element_8_0","src":"element_11","dst":"element_8"},{"id":"element_9_0","src":"element_10","dst":"element_9"}]}';
}da(b)}function N(){if(!ZyDigSim.imagesHaveLoaded)return ja.clearRect(0,0,ia.width,ia.height),void ja.fillText("Loading",ia.width/2,ia.height/2);if(ja.clearRect(0,0,ia.width,ia.height),m&&l){ja.save(),ja.strokeStyle=ZYANTE_DARK_BLUE;var a=71,b=60,c=420,e=295;ja.strokeRect(a,b,c,e),ja.fillStyle="black",ja.font="12px Helvetica";var f=12;ja.fillText("Datapath",a+c-ja.measureText("Datapath").width-5,b+e-f),ja.restore()}Q(),ja.globalAlpha=1;for(var g=0;g<la.length;g++)la[g].elementType!=Element.PASS&&la[g].elementType!=Element.LABEL&&la[g].draw(ja);if(null!=sa&&d){Oa&&(ja.globalAlpha=.5);for(var g=sa.length-1;g>=0;g--)ja.save(),ja.lineWidth=2,ja.strokeStyle=ZYANTE_DARK_ORANGE,sa[g].elementType==Element.LABEL?ja.strokeRect(sa[g].x-5,sa[g].y-5,sa[g].width+10,sa[g].height+10):ja.strokeRect(sa[g].x-5,sa[g].y-5,sa[g].width+10,sa[g].height+10),ja.lineWidth=1,ja.restore();ja.globalAlpha=1}P(),-1!==Ma&&(ja.save(),ja.strokeStyle=WIRE_COLOR,ja.beginPath(),ja.dashedLine(wa[0],wa[1],La[0],La[1]),ja.stroke(),ja.restore()),null!=za&&(ja.save(),ja.strokeStyle=ZYANTE_DARK_ORANGE,ja.beginPath(),ja.moveTo(za.origin.X,za.origin.Y),ja.lineTo(za.origin.X,za.end.Y),ja.lineTo(za.end.X,za.end.Y),ja.lineTo(za.end.X,za.origin.Y),ja.lineTo(za.origin.X,za.origin.Y),ja.stroke(),ja.restore()),DEBUG&&O(ja)}function O(a){a.save(),a.strokeStyle=ZYANTE_DARK_ORANGE;for(var b=0;b<la.length;b++){for(var c=la[b].height/(la[b].maxInput+1),d=0,e=c;d<la[b].maxInput;d++,e+=c)a.strokeRect(la[b].x-WIRE_LENGTH-WIRE_BUFFER,la[b].y+e-WIRE_BUFFER,2*WIRE_BUFFER,2*WIRE_BUFFER);la[b].operation!=ELEMENT_FUNCTIONS.OUT&&a.strokeRect(la[b].x+la[b].width,la[b].y+la[b].height/2-WIRE_BUFFER,WIRE_LENGTH+WIRE_BUFFER,2*WIRE_BUFFER)}a.restore()}function P(){-1!=va.elementIndex&&(va.isOutput?(ja.save(),ja.strokeStyle=WIRE_COLOR,ja.beginPath(),ja.moveTo(la[va.elementIndex].outputPorts[va.wireIndex].endPoint().x,la[va.elementIndex].outputPorts[va.wireIndex].endPoint().y),ja.lineTo(wa[0],wa[1]),ja.stroke(),ja.restore()):(ja.save(),ja.strokeStyle=WIRE_COLOR,ja.beginPath(),ja.moveTo(la[va.elementIndex].inputPorts[va.wireIndex].endPoint().x,la[va.elementIndex].inputPorts[va.wireIndex].endPoint().y),ja.lineTo(wa[0],wa[1]),ja.stroke(),ja.restore()))}function Q(){for(var a=0;a<la.length;a++)for(var b=0;b<la[a].outputs.length;b++)if(null!=la[a].outputs[b]){ja.beginPath();var c=la[a].outputs[b].portIndex?la[a].outputs[b].portIndex:0;ja.moveTo(la[a].outputPorts[c].endPoint().x,la[a].outputPorts[c].endPoint().y);var d=la[a].outputs[b].inputIndex;ja.lineTo(la[a].outputs[b].outputEle.inputPorts[d].endPoint().x,la[a].outputs[b].outputEle.inputPorts[d].endPoint().y),la[a].bitWidth>1?ja.strokeStyle=ZYANTE_DARK_BLUE:la[a].value==ELEMENT_VALUES.TRUE?ja.strokeStyle=ZYANTE_GREEN:la[a].value==ELEMENT_VALUES.FALSE?ja.strokeStyle=ZYANTE_MEDIUM_RED:ja.strokeStyle=WIRE_COLOR;for(var e=0;e<Fa.length;e++)if(!Fa[e].isOutput&&Fa[e].elementIndex==la.indexOf(la[a].outputs[b].outputEle)&&Fa[e].wireIndex==la[a].outputs[b].inputIndex){ja.lineWidth=2,ja.strokeStyle=ZYANTE_DARK_ORANGE;break}if(la[a].outputPorts[0].bitWidth>1){ja.font="12px Helvetica";var f={x:(la[a].outputPorts[c].endPoint().x+la[a].outputs[b].outputEle.inputPorts[d].endPoint().x)/2,y:(la[a].outputPorts[c].endPoint().y+la[a].outputs[b].outputEle.inputPorts[d].endPoint().y)/2};ja.moveTo(f.x-QUARTER_WIRE_LENGTH,f.y+QUARTER_WIRE_LENGTH),ja.lineTo(f.x+QUARTER_WIRE_LENGTH,f.y-QUARTER_WIRE_LENGTH),ja.fillStyle=ja.strokeStyle}ja.stroke(),ja.lineWidth=1}}function R(){if(Ma=-1,Na=-1,wa&&-1!==va.elementIndex)for(var a=0;a<la.length;a++)if(la[a].shouldDraw)if(va.isOutput){if(va.isOutput)for(var b=0;b<la[a].inputPorts.length;b++)if(null===la[a].inputs[b]){var c=la[a].inputPorts[b].endPoint().x,d=la[a].inputPorts[b].endPoint().y;-1===Ma&&a!==va.elementIndex&&la[va.elementIndex].outputPorts[va.wireIndex].bitWidth==la[a].inputPorts[b].bitWidth?(Ma=a,Na=b,La=[c,d]):a!==va.elementIndex&&la[va.elementIndex].outputPorts[va.wireIndex].bitWidth==la[a].inputPorts[b].bitWidth&&Math.pow(wa[0]-c,2)+Math.pow(wa[1]-d,2)<Math.pow(wa[0]-La[0],2)+Math.pow(wa[1]-La[1],2)&&(La=[c,d],Na=b,Ma=a)}}else for(var b=0;b<la[a].outputPorts.length;b++){var c=la[a].outputPorts[b].endPoint().x,d=la[a].outputPorts[b].endPoint().y;la[va.elementIndex].inputPorts[va.wireIndex].bitWidth==la[a].outputPorts[b].bitWidth&&-1===Ma&&a!==va.elementIndex&&la[a].elementType!==Element.OUT&&la[a].elementType!==Component.OUT?(Ma=a,Na=b,La=[c,d]):la[a].elementType!==Element.OUT&&la[a].elementType!==Component.OUT&&a!==va.elementIndex&&la[va.elementIndex].inputPorts[va.wireIndex].bitWidth==la[a].outputPorts[b].bitWidth&&Math.pow(wa[0]-c,2)+Math.pow(wa[1]-d,2)<Math.pow(wa[0]-La[0],2)+Math.pow(wa[1]-La[1],2)&&a!==va.elementIndex&&(La=[c,d],Na=b,Ma=a)}}function S(){if(ma--,0==ma){T(),_();for(var a=0;a<ZyDigSim.imagesHaveLoadedCallbacks.length;a++)ZyDigSim.imagesHaveLoadedCallbacks[a]()}}function T(){for(var b=0;b<qa.length;b++)qa[b].draw(pa);var c=5,d=1,e=25,f=0;qa[0].elementType===Element.IN?qa[0].moveTo(d,qa[0].y):qa[0].moveTo(HALF_WIRE_LENGTH+d,qa[0].y);var g=!0;-1==qa[0].elementType.indexOf("component")?qa[0].updateDimensions({width:qa[0].img.width,height:qa[0].img.height}):(qa[0].x=0,qa[0].y=e,g=!1);for(var b=1;b<qa.length;b++)if(-1==qa[b].elementType.indexOf("component")?(qa[b].updateDimensions({width:qa[b].img.width,height:qa[b].img.height}),c=5,qa[b].moveTo(HALF_WIRE_LENGTH+d,qa[b].y)):(qa[b].x=0,c=5),qa[b].elementType==Element.OUT){var h=0>b-2?0:qa[b-2].y,i=0>b-2?0:qa[b-2].height,j=1==b?0:c;qa[b].moveTo(WIRE_LENGTH+(qa[b-1].x+qa[b-1].width)+4*c,h+i+j)}else qa[b].elementType==Element.IN?qa[b].moveTo(0,qa[b-1].y+qa[b-1].height+c):-1!=qa[b].elementType.indexOf("component")&&g?(g=!1,f=qa[b-1].height+c+e,qa[b].moveTo(d,qa[b-1].y+qa[b-1].height+c+2*e)):-1!=qa[b].elementType.indexOf("component")?qa[b].moveTo(d,qa[b-1].y+qa[b-1].height+c):qa[b].moveTo(HALF_WIRE_LENGTH+d,qa[b-1].y+qa[b-1].height+c);for(var b=0;b<la.length;b++)-1==la[b].elementType.indexOf("component")&&la[b].updateDimensions({width:la[b].img.width,height:la[b].img.height});oa.height=qa[qa.length-1].y+qa[qa.length-1].height+WIRE_LENGTH,$("#"+a+" .toolbox-container").height($("#"+a+" .toolbox-container").height()<$("#"+a+" .middle-container").height()?$("#"+a+" .middle-container").height():$("#"+a+" .toolbox-container").height()),ZyDigSim.imagesHaveLoaded=!0,pa.clearRect(0,0,oa.width,oa.height);for(var b=0;b<qa.length;b++)if(qa[b].draw(pa),qa[b].elementType==Element.IN){pa.save(),pa.fillStyle=ZYANTE_DARK_BLUE;var k=14;pa.font="bold 14px Helvetica";var l="In";pa.translate(qa[b].x+qa[b].width/2-pa.measureText(l).width/2,qa[b].y+qa[b].height/2+k/2),pa.rotate(90*Math.PI/180),pa.translate(-(qa[b].x+qa[b].width/2-pa.measureText(l).width/2),-(qa[b].y+qa[b].height/2+k/2)),pa.fillText(l,qa[b].x-pa.measureText(l).width,qa[b].y+qa[b].height/2+k/2),pa.restore()}else if(qa[b].elementType==Element.OUT){pa.save(),pa.fillStyle=ZYANTE_DARK_BLUE;var k=14;pa.font="bold 14px Helvetica";var l="Out";pa.translate(qa[b].x+qa[b].width/2-pa.measureText(l).width/2,qa[b].y+qa[b].height/2+k/2),pa.rotate(90*Math.PI/180),pa.translate(-(qa[b].x+qa[b].width/2-pa.measureText(l).width/2),-(qa[b].y+qa[b].height/2+k/2)),pa.fillText(l,qa[b].x-pa.measureText(l).width,qa[b].y+qa[b].height/2),pa.restore()}if(m){var n="All datapath components are 8-bits";pa.save(),pa.fillStyle=ZYANTE_DARK_BLUE,pa.font="14px Helvetica",pa.textBaseline="middle",pa.fillText(n,0,f),pa.restore()}}function U(){n&&(qa.push(new Element(0,0,ZyDigSim.imageAssets.andImg,ELEMENT_FUNCTIONS.AND,2,"and","")),j||qa.push(new Element(0,0,ZyDigSim.imageAssets.nandImg,ELEMENT_FUNCTIONS.NAND,2,"nand","")),qa.push(new Element(0,0,ZyDigSim.imageAssets.orImg,ELEMENT_FUNCTIONS.OR,2,"or","")),j||qa.push(new Element(0,0,ZyDigSim.imageAssets.norImg,ELEMENT_FUNCTIONS.NOR,2,"nor","")),j||qa.push(new Element(0,0,ZyDigSim.imageAssets.xorImg,ELEMENT_FUNCTIONS.XOR,2,"xor","")),qa.push(new Element(0,0,ZyDigSim.imageAssets.notImg,ELEMENT_FUNCTIONS.NOT,1,"not",""))),(!l||m)&&(qa.push(new Element(0,0,ZyDigSim.imageAssets.inImg,ELEMENT_FUNCTIONS.IN,0,"in","")),qa.push(new Element(0,0,ZyDigSim.imageAssets.outImg,ELEMENT_FUNCTIONS.OUT,1,"out",""))),m&&(qa.push(new Component(0,0,Component.CONSTANT,8)),l||(qa.push(new Component(0,0,Component.IN,8)),qa.push(new Component(0,0,Component.OUT,8))),qa.push(new Component(0,0,Component.ADDER,8)),qa.push(new Component(0,0,Component.COMPARATOR,8)),qa.push(new Component(0,0,Component.MUX,8)),qa.push(new Component(0,0,Component.LOAD_REGISTER,8)))}function V(){ZyDigSim.imageAssets={zeroImg:null,oneImg:null,andImg:null,orImg:null,inImg:null,norImg:null,notImg:null,xorImg:null,outImg:null,undefinedImg:null,nandImg:null,labelImg:null},ZyDigSim.imagesHaveLoadedCallbacks=[],ZyDigSim.imagesHaveLoaded=!1,ma=Object.keys(ZyDigSim.imageAssets).length,ZyDigSim.imageAssets.andImg=new Image,ZyDigSim.imageAssets.andImg.src=b.getResourceURL("and.png",c),ZyDigSim.imageAssets.andImg.onload=S,ZyDigSim.imageAssets.nandImg=new Image,ZyDigSim.imageAssets.nandImg.src=b.getResourceURL("nand.png",c),ZyDigSim.imageAssets.nandImg.onload=S,ZyDigSim.imageAssets.orImg=new Image,ZyDigSim.imageAssets.orImg.src=b.getResourceURL("or.png",c),ZyDigSim.imageAssets.orImg.onload=S,ZyDigSim.imageAssets.norImg=new Image,ZyDigSim.imageAssets.norImg.src=b.getResourceURL("nor.png",c),ZyDigSim.imageAssets.norImg.onload=S,ZyDigSim.imageAssets.xorImg=new Image,ZyDigSim.imageAssets.xorImg.src=b.getResourceURL("xor.png",c),ZyDigSim.imageAssets.xorImg.onload=S,ZyDigSim.imageAssets.notImg=new Image,ZyDigSim.imageAssets.notImg.src=b.getResourceURL("not.png",c),ZyDigSim.imageAssets.notImg.onload=S,ZyDigSim.imageAssets.inImg=new Image,ZyDigSim.imageAssets.inImg.src=b.getResourceURL("in.png",c),ZyDigSim.imageAssets.inImg.onload=S,ZyDigSim.imageAssets.outImg=new Image,ZyDigSim.imageAssets.outImg.src=b.getResourceURL("out.png",c),ZyDigSim.imageAssets.outImg.onload=S,ZyDigSim.imageAssets.labelImg=new Image,ZyDigSim.imageAssets.labelImg.src=b.getResourceURL("label.png",c),ZyDigSim.imageAssets.labelImg.onload=S,ZyDigSim.imageAssets.oneImg=new Image,ZyDigSim.imageAssets.oneImg.src=b.getResourceURL("one.png",c),ZyDigSim.imageAssets.oneImg.onload=S,ZyDigSim.imageAssets.zeroImg=new Image,ZyDigSim.imageAssets.zeroImg.src=b.getResourceURL("zero.png",c),ZyDigSim.imageAssets.zeroImg.onload=S,ZyDigSim.imageAssets.undefinedImg=new Image,ZyDigSim.imageAssets.undefinedImg.src=b.getResourceURL("que.png",c),ZyDigSim.imageAssets.undefinedImg.onload=S,U()}function W(a,b,c){void 0==c&&(c=0);for(var d=null,e=la.length-1;e>=c;e--)if(la[e].shouldDraw&&fa(a,b,la[e].x,la[e].y,la[e].width,la[e].height)){d=la[e];break}return d}function X(a,b,c){for(var d={elementIndex:-1,wireIndex:-1,isOutput:!0,onlyForSelection:!1},e=0;e<la.length;e++)if(la[e].shouldDraw){for(var f=0;f<la[e].inputPorts.length;f++){var g=la[e].inputPorts[f].endPoint();if(fa(a,b,g.x-WIRE_BUFFER,g.y-WIRE_BUFFER,2*WIRE_BUFFER,2*WIRE_BUFFER)&&null==la[e].inputs[f]&&(void 0==c||c==e))return d={elementIndex:e,wireIndex:f,isOutput:!1}}if(la[e].elementType!=Element.OUT&&la[e].elementType!=Element.LABEL)for(var f=0;f<la[e].outputPorts.length;f++){var g=la[e].outputPorts[f].endPoint();if(fa(a,b,g.x-WIRE_BUFFER,g.y-WIRE_BUFFER,WIRE_LENGTH+WIRE_BUFFER,2*WIRE_BUFFER)&&(void 0==c||c==e))return d={elementIndex:e,wireIndex:f,isOutput:!0}}}for(var e=0;e<la.length;e++)if(la[e].shouldDraw)for(var f=0;f<la[e].maxInput;f++){var h=la.indexOf(la[e].inputs[f]);if(h>=0&&(Y(a-25,b-25,50,50),Fa.length>0&&(void 0==c||c==Fa[0].elementIndex)))return d=Fa[0],d.onlyForSelection=!0,d}return d}function Y(a,b,c,d){Fa=[],Z(a,b,a+c,b),Z(a,b,a,b+d),Z(a+c,b,a+c,b+d),Z(a,b+d,a+c,b+d);for(var e=[],f={elementIndex:-1,wireIndex:-1,isOutput:!0},g=0;g<la.length;g++)if(la[g].shouldDraw)for(var h=0;h<la[g].maxInput;h++){var i=la.indexOf(la[g].inputs[h]);if(i>=0){var j=a,k=b,l=a+c,m=b+d,n=la[i].x+la[i].width,o=la[i].y+la[i].height/2-WIRE_BUFFER,p=la[g].inputPorts[h].endPoint().x,q=la[g].inputPorts[h].endPoint().y;n>=j&&l>=n&&p>=j&&l>=p&&o>=k&&m>=o&&q>=k&&m>=q&&(f={elementIndex:g,wireIndex:h,isOutput:!1},e.push(f))}}for(var g=0;g<e.length;g++){for(var r=!1,h=0;h<Fa.length;h++)if(Fa[h].elementIndex==e[g].elementIndex&&Fa[h].wireIndex==e[g].wireIndex){r=!0;break}r||Fa.push(e[g])}}function Z(a,b,c,d){for(var e=[],f={elementIndex:-1,wireIndex:-1,isOutput:!0},g=0;g<la.length;g++)if(la[g].shouldDraw)for(var h=0;h<la[g].maxInput;h++){var i=la.indexOf(la[g].inputs[h]);i>=0&&ha(a,b,c,d,la[i].x+la[g].width,la[i].y+la[g].height/2-WIRE_BUFFER,la[g].inputPorts[h].endPoint().x,la[g].inputPorts[h].endPoint().y)&&(f={elementIndex:g,wireIndex:h,isOutput:!1},e.push(f))}for(var g=0;g<e.length;g++){for(var j=!1,h=0;h<Fa.length;h++)if(Fa[h].elementIndex==e[g].elementIndex&&Fa[h].wireIndex==e[g].wireIndex){j=!0;break}j||Fa.push(e[g])}}function _(){for(ya=la.length-1;ya>xa;){for(var a=0;a<la.length;a++)la[a].update(ja);xa++}N()}function aa(){$("#deleteSelectedItemsButton_"+a).prop("disabled",!0),$("#deleteSelectedItemsButton_"+a).addClass("disabled");var b=!1;if(Fa.length>0){for(var c=0;c<Fa.length;c++){for(var d=0;d<la[Fa[c].elementIndex].inputs[Fa[c].wireIndex].outputs.length;d++)if(null!=la[Fa[c].elementIndex].inputs[Fa[c].wireIndex]&&null!=la[Fa[c].elementIndex].inputs[Fa[c].wireIndex].outputs[d]&&la[Fa[c].elementIndex].inputs[Fa[c].wireIndex].outputs[d].outputEle==la[Fa[c].elementIndex]&&la[Fa[c].elementIndex].inputs[Fa[c].wireIndex].outputs[d].inputIndex==Fa[c].wireIndex){la[Fa[c].elementIndex].inputs[Fa[c].wireIndex].outputs.splice(d,1);break}la[Fa[c].elementIndex].inputs[Fa[c].wireIndex]=null}b=!0}if(null!==sa){for(var e=0;e<sa.length;e++){for(var f=sa[e],c=0;c<f.inputs.length;c++)if(null!=f.inputs[c])for(var d=0;d<f.inputs[c].outputs.length;d++)(null==f.inputs[c].outputs[d]||f.inputs[c].outputs[d].outputEle==f)&&f.inputs[c].outputs.splice(d,1);for(var c=0;c<f.outputs.length;c++)if(null!=f.outputs[c])for(var d=0;d<f.outputs[c].outputEle.inputs.length;d++)f.outputs[c].outputEle.inputs[d]==f&&(f.outputs[c].outputEle.inputs[d]=null);f.operation==ELEMENT_FUNCTIONS.LABEL&&$("#label"+f.labelID+"_"+a).remove();var g=la.indexOf(f);la.splice(g,1)}b=!0}b&&(xa=0,sa=null,Fa=[],Ca.pushState(ea()),_())}function ba(){da($("#JSONLoadSave_"+a).val())}function ca(){$("#JSONLoadSave_"+a).val(ea())}function da(b){if(null!=b&&b.length){var c=JSON.parse(b);if(!(c.elements.length<=0)){sa=null,$("#"+a).find(".label").each(function(){$(this).remove()}),la=new Array(c.elements.length),c.elements.forEach(function(a){var b=parseInt(a.id.substring(a.id.lastIndexOf("_")+1),10),c=null,d=null;switch(a.type){case Element.AND:c=ELEMENT_FUNCTIONS.AND,d=ZyDigSim.imageAssets.andImg;break;case Element.OR:c=ELEMENT_FUNCTIONS.OR,d=ZyDigSim.imageAssets.orImg;break;case Element.XOR:c=ELEMENT_FUNCTIONS.XOR,d=ZyDigSim.imageAssets.xorImg;break;case Element.NOT:c=ELEMENT_FUNCTIONS.NOT,d=ZyDigSim.imageAssets.notImg;break;case Element.IN:c=ELEMENT_FUNCTIONS.IN,d=ZyDigSim.imageAssets.zeroImg;break;case Element.OUT:c=ELEMENT_FUNCTIONS.OUT,d=ZyDigSim.imageAssets.zeroImg;break;case Element.NAND:c=ELEMENT_FUNCTIONS.NAND,d=ZyDigSim.imageAssets.nandImg;break;case Element.NOR:c=ELEMENT_FUNCTIONS.NOR,d=ZyDigSim.imageAssets.norImg;break;case Element.LABEL:c=ELEMENT_FUNCTIONS.LABEL,d=ZyDigSim.imageAssets.labelImg}var e="undefined"==typeof a.shouldDraw?!0:a.shouldDraw;if(-1===a.type.indexOf("component")?la[b]=new Element(parseInt(a.x,10),parseInt(a.y,10),d,c,parseInt(a.maxInput,10),a.type,a.name,!1):(la[b]=new Component(parseInt(a.x,10),parseInt(a.y,10),a.type,a.bitWidth,!1),la[b].name=a.name),la[b].value=parseInt(a.currentVal,10),la[b].shouldDraw=e,la[b].operation===ELEMENT_FUNCTIONS.LABEL){la[b].value=a.currentVal;var f=la[b];E(f)}});for(var d=0;d<c.connections.length;d++){var e=c.connections[d],f=parseInt(e.src.substring(e.src.lastIndexOf("_")+1)),g=parseInt(e.dst.substring(e.dst.lastIndexOf("_")+1)),h=parseInt(e.id.substring(e.id.lastIndexOf("_")+1)),i=e.portIndex?parseInt(e.portIndex,10):0;isNaN(f)||(la[g].connectInput(la[f],h,i),la[f].connectOutput(la[g],h,i))}xa=0,_()}}}function ea(){for(var a={elements:[],connections:[]},b=0;b<la.length;b++){a.elements.push({id:"element_"+b,type:la[b].elementType,x:la[b].x,y:la[b].y,maxInput:la[b].maxInput,currentVal:la[b].value,name:la[b].name?la[b].name:"",bitWidth:la[b].bitWidth?la[b].bitWidth:1,shouldDraw:la[b].shouldDraw});for(var c=0;c<la[b].outputs.length;c++){var d=la.indexOfObject(la[b].outputs[c].outputEle);-1==d&&(d="null");var e=la[b].outputs[c].portIndex?la[b].outputs[c].portIndex:0;a.connections.push({id:"element_"+c+"_"+la[b].outputs[c].inputIndex,src:"element_"+b,dst:"element_"+d,portIndex:e})}}return JSON.stringify(a)}function fa(a,b,c,d,e,f){return a>=c&&c+e>=a&&b>=d&&d+f>=b}function ga(a,b,c,d,e,f,g,h){return!(a>e+g||e>a+c||b>f+h||f>b+d)}function ha(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t;return i=d-b,k=a-c,m=c*b-a*d,q=i*e+k*f+m,r=i*g+k*h+m,0!=q&&0!=r&&q*r>=0?INTERSECTION.NO_INTERSECT:(j=h-f,l=e-g,n=g*f-e*h,o=j*a+l*b+n,p=j*c+l*d+n,0!=o&&0!=p&&o*p>=0?INTERSECTION.NO_INTERSECT:(s=i*l-j*k,0==s?INTERSECTION.COLLINEAR:(t=0>s?-s/2:s/2,INTERSECTION.DO_INTERSECT)))}var ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa=this;o.prototype.pushState=function(b){this.undoRedoIndex+1>=this.maxSize?(this.undoRedoStack.splice(0,1),this.undoRedoStack[this.undoRedoIndex]=b):(this.undoRedoStack.splice(this.undoRedoIndex,this.undoRedoStack.length-this.undoRedoIndex),this.undoRedoStack.push(b),this.undoRedoIndex++,this.empty()||($("#undoButton_"+a).prop("disabled",!1),$("#undoButton_"+a).removeClass("disabled")))},o.prototype.undo=function(){return this.undoRedoIndex>0?(this.undoRedoIndex--,sa=null,Fa=[],z(),this.empty()&&($("#undoButton_"+a).prop("disabled",!0),$("#undoButton_"+a).addClass("disabled")),this.undoRedoStack[this.undoRedoIndex-1]):null},o.prototype.redo=function(){return this.undoRedoIndex<this.undoRedoStack.length?(this.undoRedoIndex++,sa=null,Fa=[],z(),this.empty()||($("#undoButton_"+a).prop("disabled",!1),$("#undoButton_"+a).removeClass("disabled")),this.undoRedoStack[this.undoRedoIndex-1]):null},o.prototype.empty=function(){return 1===this.undoRedoIndex},o.prototype.reset=function(b){this.undoRedoStack=[b],this.undoRedoIndex=1,sa=null,Fa=[],z(),$("#undoButton_"+a).prop("disabled",!0),$("#undoButton_"+a).addClass("disabled")},Array.prototype.indexOfObject=function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},p()}}var module={},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};Component.IN="in-component",Component.OUT="out-component",Component.ADDER="adder-component",Component.MUX="mux-component",Component.COMPARATOR="comparator-component",Component.LOAD_REGISTER="load_register-component",Component.CONSTANT="constant-component";var COMPONENT_CONSTANTS={TOOLBOX_DRAWING:{normalBackgroundColor:"white",constantBackgroundColor:"#DCDCDC",nameFont:"14px Helvetica",nameFontcolor:"black",borderColor:"#5780A6"},NORMAL_DRAWING:{normalBackgroundColor:"white",constantBackgroundColor:"#DCDCDC",nameFont:"14px Helvetica",nameFontcolor:"black",borderColor:"#5780A6",valueFont:"14px Helvetica",valueFontColor:"#5780A6"}};Component.prototype.connectInput=function(a,b,c){void 0==c&&(c=0),this.inputPorts[b].connectInput(a.outputPorts[c]),this.inputs[b]=a},Component.prototype.connectOutput=function(a,b,c){void 0==c&&(c=0),this.outputPorts[c].connectOutput(a.inputPorts[b]),this.outputs.push({outputEle:a,inputIndex:b,portIndex:c})},Component.prototype.moveTo=function(a,b){var c=a-this.x,d=b-this.y;this.x=a,this.y=b;for(var e=0;e<this.inputPorts.length;e++)this.inputPorts[e].x+=c,this.inputPorts[e].y+=d;for(var e=0;e<this.outputPorts.length;e++)this.outputPorts[e].x+=c,this.outputPorts[e].y+=d},Component.prototype.update=function(a){if(this.elementType===Component.IN||this.elementType===Component.CONSTANT)for(var b=0;b<this.outputPorts.length;b++){for(var c=0;c<this.outputPorts[b].connectors.length;c++)this.outputPorts[b].connectors[c].value=this.value>>c&1;this.outputPorts[b].update()}else{for(var b=0;b<this.inputPorts.length;b++)this.inputPorts[b].update();if(this.elementType==Component.LOAD_REGISTER)if(0==this.previousClkValue&&1==this.clk.connectors[0].value){if(this.previousClkValue=1,this.e.value=1,this.e.update(),1==this.ld.connectors[0].value){this.loading=!0;var d=this;setTimeout(function(){d.loading=!1,d.draw(a)},500)}}else 0==this.clk.connectors[0].value?(this.previousClkValue=0,this.e.value=0,this.e.update()):1==this.clk.connectors[0].value&&(this.e.value=0,this.e.update());for(var b=0;b<this.elements.length;b++)this.elements[b].update();for(var b=0;b<this.outputPorts.length;b++)this.outputPorts[b].update();for(var e=0,f=!0,b=0;b<this.bitWidth;b++)if(this.elementType==Component.OUT&&this.inputPorts[0].connectors[b].value!=ELEMENT_VALUES.UNDEFINED)e+=this.inputPorts[0].connectors[b].value<<b;else{if(this.elementType!=Component.ADDER||this.outputPorts[0].connectors[b].value==ELEMENT_VALUES.UNDEFINED){f=!1;break}e+=this.outputPorts[0].connectors[b].value<<b}f&&(this.value=e)}},Component.prototype.createAndPlaceInputPorts=function(a,b,c,d){for(var e=0,f=b;c>e;e++,f+=a)this.inputPorts[e]=new Port(this.x+f,this.y-HALF_WIRE_LENGTH,d,!0)},Component.prototype.initInputs=function(){for(var a=0;a<this.maxInput;a++)this.inputs.push(null)},Component.prototype.intializeActualWidthHeight=function(){this.actualWidth=this.width,this.actualHeight=this.height},Component.prototype.buildInput=function(){this.name="In",this.displayValue=!0,this.width=40,this.height=40,this.intializeActualWidthHeight(),this.inputPorts=[],this.outputPorts[0]=new Port(this.x+this.width/2,this.y+this.height-HALF_WIRE_LENGTH,this.bitWidth,!0),this.outputPorts[0].updateName("",!0)},Component.prototype.buildOutput=function(){this.name="Out",this.displayValue=!0,this.width=40,this.height=40,this.intializeActualWidthHeight(),this.maxInput=1,this.initInputs(),this.inputPorts[0]=new Port(this.x+this.width/2,this.y-HALF_WIRE_LENGTH,this.bitWidth,!0),this.outputPorts=[]},Component.prototype.buildConstant=function(){this.name="Constant",this.displayValue=!0,this.width=30,this.height=25,this.intializeActualWidthHeight(),this.inputPorts=[],1===this.bitWidth?this.outputPorts[0]=new Port(this.x+this.width-HALF_WIRE_LENGTH,this.y+this.height/2,this.bitWidth,!1):this.outputPorts[0]=new Port(this.x+this.width/2,this.y+this.height-HALF_WIRE_LENGTH,this.bitWidth,!0),this.outputPorts[0].updateName("",!0)},Component.prototype.buildLoadRegister=function(){this.width=130,this.height=65,this.intializeActualWidthHeight(),this.maxInput=3,this.initInputs(),this.name="Load Register";var a=this.width/2;this.createAndPlaceInputPorts(a,a,1,this.bitWidth),this.inputPorts[0].updateName("D",!1),this.inputPorts[1]=new Port(this.x-HALF_WIRE_LENGTH,this.y+this.height/3,1),this.inputPorts[1].updateName("ld",!1),this.inputPorts[2]=new Port(this.x-HALF_WIRE_LENGTH,this.y+2*this.height/3,1),this.inputPorts[2].updateName("clk",!1),this.outputPorts[0]=new Port(this.x+this.width/2,this.y+this.height-HALF_WIRE_LENGTH,this.bitWidth,!0),this.outputPorts[0].updateName("Q",!0),this.previousClkValue=0,this.clk=this.inputPorts[2];var b=createInternalStorage();b.value=0,b.update(),this.e=b,this.ld=this.inputPorts[1];for(var c=0;c<this.bitWidth;c++){var d=this.inputPorts[1],e=new Component(0,0,Component.MUX,1,!1,!1),f=e.outputPorts[0],g=createInternalNOT();f.connectOutput(g.inputPorts[0],0,0),g.inputPorts[0].connectInput(f,0,0);var h=createInternalAND();g.connectOutput(h,0),h.connectInput(g,0),b.connectOutput(h,1),h.connectInput(b,1);var i=createInternalAND();f.connectOutput(i.inputPorts[0],0,0),i.inputPorts[0].connectInput(f,0,0),b.connectOutput(i,1),i.connectInput(b,1);var j=createInternalNOR(),k=createInternalNOR();i.connectOutput(j,0),j.connectInput(i,0),k.connectOutput(j,1),j.connectInput(k,1),h.connectOutput(k,0),k.connectInput(h,0),j.connectOutput(k,1),k.connectInput(j,1),k.outputPorts[0].connectOutput(e.inputPorts[0],0,0),e.inputPorts[0].connectInput(k.outputPorts[0],0,0),this.inputPorts[0].connectOutput(e.inputPorts[1],0,c),e.inputPorts[1].connectInput(this.inputPorts[0],0,c),d.connectOutput(e.inputPorts[2],0,0),e.inputPorts[2].connectInput(d,0,0),this.outputPorts[0].connectInput(k.outputPorts[0],c,0),k.outputPorts[0].connectOutput(this.outputPorts[0],c,0),this.elements.push(e),this.elements.push(g),this.elements.push(h),this.elements.push(i),this.elements.push(j),this.elements.push(k)}},Component.prototype.buildMux=function(){this.width=95,this.height=65,this.intializeActualWidthHeight(),this.maxInput=3,this.initInputs(),this.name="Mux";var a=this.width/this.maxInput;this.createAndPlaceInputPorts(a,a,this.maxInput-1,this.bitWidth),this.inputPorts[0].updateName("A",!1),this.inputPorts[1].updateName("B",!1),this.inputPorts[2]=new Port(this.x-HALF_WIRE_LENGTH,this.y+this.height/2,1),this.inputPorts[2].updateName("s",!1),this.outputPorts[0]=new Port(this.x+this.width/2,this.y+this.height-HALF_WIRE_LENGTH,this.bitWidth,!0),this.outputPorts[0].updateName("Y",!0);for(var b=0;b<this.bitWidth;b++){var c=this.inputPorts[2],d=this.inputPorts[0],e=this.inputPorts[1],f=createInternalNOT(),g=createInternalNOT(),h=createInternalNOT();c.connectOutput(f.inputPorts[0],0,0),f.inputPorts[0].connectInput(c,0,0),d.connectOutput(h.inputPorts[0],0,b),h.inputPorts[0].connectInput(d,0,b),e.connectOutput(g.inputPorts[0],0,b),g.inputPorts[0].connectInput(e,0,b);var i=createInternalAND();f.connectOutput(i,0),i.connectInput(f,0),d.connectOutput(i.inputPorts[1],0,b),i.inputPorts[1].connectInput(d,0,b);var j=createInternalAND();i.connectOutput(j,0),j.connectInput(i,0),e.connectOutput(j.inputPorts[1],0,b),j.inputPorts[1].connectInput(e,0,b);var k=createInternalAND();i.connectOutput(k,0),k.connectInput(i,0),g.connectOutput(k,1),k.connectInput(g,1);var l=createInternalOR();j.connectOutput(l,0),l.connectInput(j,0),k.connectOutput(l,1),l.connectInput(k,1);var m=createInternalAND();c.connectOutput(m.inputPorts[0],0,0),m.inputPorts[0].connectInput(c,0,0),d.connectOutput(m.inputPorts[1],0,b),m.inputPorts[1].connectInput(d,0,b);var n=createInternalAND();m.connectOutput(n,0),n.connectInput(m,0),e.connectOutput(n.inputPorts[1],0,b),n.inputPorts[1].connectInput(e,0,b);var o=createInternalAND();c.connectOutput(o.inputPorts[0],0,0),o.inputPorts[0].connectInput(c,0,0),h.connectOutput(o,1),o.connectInput(h,1);var p=createInternalAND();o.connectOutput(p,0),p.connectInput(o,0),e.connectOutput(p.inputPorts[1],0,b),p.inputPorts[1].connectInput(e,0,b);var q=createInternalOR();n.connectOutput(q,0),q.connectInput(n,0),p.connectOutput(q,1),q.connectInput(p,1);var r=createInternalOR();l.connectOutput(r,0),r.connectInput(l,0),q.connectOutput(r,1),r.connectInput(q,1),this.outputPorts[0].connectInput(r.outputPorts[0],b,0),r.outputPorts[0].connectOutput(this.outputPorts[0],b,0),this.elements.push(f),this.elements.push(g),this.elements.push(h),this.elements.push(i),this.elements.push(j),this.elements.push(k),this.elements.push(l),this.elements.push(m),this.elements.push(n),this.elements.push(o),this.elements.push(p),this.elements.push(q),this.elements.push(r)}},Component.prototype.buildComparator=function(){this.width=130,this.height=65,this.intializeActualWidthHeight(),this.maxInput=2,this.initInputs(),this.name="Comparator";var a=this.width/(this.maxInput+1);this.createAndPlaceInputPorts(a,a,this.maxInput,this.bitWidth),this.inputPorts[0].updateName("A",!1),this.inputPorts[1].updateName("B",!1);for(var b=3,a=this.width/(b+1),c=0,d=a;b>c;c++,d+=a)this.outputPorts[c]=new Port(this.x+d,this.y+this.height-HALF_WIRE_LENGTH,1,!0);this.outputPorts[0].updateName("gt",!0),this.outputPorts[1].updateName("lt",!0),this.outputPorts[2].updateName("eq",!0);var e=createInternalStorage(),f=createInternalStorage(),g=createInternalStorage();e.value=0,f.value=0,g.value=1,e.update(),f.update(),g.update();for(var h=0;h<this.bitWidth;h++){var i,j=this.inputPorts[0],k=this.inputPorts[1],l=createInternalNOT(),m=createInternalAND(),n=createInternalAND(),o=createInternalOR();k.connectOutput(l.inputPorts[0],0,this.bitWidth-h-1),l.inputPorts[0].connectInput(k,0,this.bitWidth-h-1),j.connectOutput(m.inputPorts[0],0,this.bitWidth-h-1),m.inputPorts[0].connectInput(j,0,this.bitWidth-h-1),l.connectOutput(m,1),m.connectInput(l,1),m.connectOutput(n,0),n.connectInput(m,0),g.connectOutput(n,1),n.connectInput(g,1),f.connectOutput(o,0),o.connectInput(f,0),n.connectOutput(o,1),o.connectInput(n,1),i=o;var p,q=createInternalNOT(),r=createInternalAND(),s=createInternalAND(),t=createInternalOR();j.connectOutput(q.inputPorts[0],0,this.bitWidth-h-1),q.inputPorts[0].connectInput(j,0,this.bitWidth-h-1),q.connectOutput(r,0),r.connectInput(q,0),k.connectOutput(r.inputPorts[1],0,this.bitWidth-h-1),r.inputPorts[1].connectInput(k,0,this.bitWidth-h-1),r.connectOutput(s,0),s.connectInput(r,0),g.connectOutput(s,1),s.connectInput(g,1),e.connectOutput(t,0),t.connectInput(e,0),s.connectOutput(t,1),t.connectInput(s,1),p=t;var u,v=createInternalXOR(),w=createInternalNOT(),x=createInternalAND();j.connectOutput(v.inputPorts[0],0,this.bitWidth-h-1),v.inputPorts[0].connectInput(j,0,this.bitWidth-h-1),k.connectOutput(v.inputPorts[1],0,this.bitWidth-h-1),v.inputPorts[1].connectInput(k,0,this.bitWidth-h-1),v.connectOutput(w,0),w.connectInput(v,0),g.connectOutput(x,0),x.connectInput(g,0),w.connectOutput(x,1),x.connectInput(w,1),u=x,this.elements.push(l),this.elements.push(m),this.elements.push(n),this.elements.push(o),this.elements.push(q),this.elements.push(r),this.elements.push(s),this.elements.push(t),this.elements.push(v),this.elements.push(w),this.elements.push(x),f=i,e=p,g=u}this.outputPorts[0].connectInput(f.outputPorts[0],0,0),f.outputPorts[0].connectOutput(this.outputPorts[0],0,0),this.outputPorts[1].connectInput(e.outputPorts[0],0,0),e.outputPorts[0].connectOutput(this.outputPorts[1],0,0),this.outputPorts[2].connectInput(g.outputPorts[0],0,0),g.outputPorts[0].connectOutput(this.outputPorts[2],0,0)},Component.prototype.buildAdder=function(){this.width=115,this.height=65,this.intializeActualWidthHeight(),this.maxInput=2,this.initInputs(),this.name="Adder";var a=this.width/(this.maxInput+1);this.createAndPlaceInputPorts(a,a,this.maxInput,this.bitWidth),this.inputPorts[0].updateName("A",!1),this.inputPorts[1].updateName("B",!1),this.outputPorts[0]=new Port(this.x+this.width/2,this.y+this.height-HALF_WIRE_LENGTH,this.bitWidth,!0),this.outputPorts[0].updateName("S",!0);var b=createInternalXOR(),c=createInternalAND();this.inputPorts[0].connectOutput(b.inputPorts[0],0,0),b.inputPorts[0].connectInput(this.inputPorts[0],0,0),this.inputPorts[1].connectOutput(b.inputPorts[1],0,0),b.inputPorts[1].connectInput(this.inputPorts[1],0,0),this.inputPorts[0].connectOutput(c.inputPorts[0],0,0),c.inputPorts[0].connectInput(this.inputPorts[0],0,0),this.inputPorts[1].connectOutput(c.inputPorts[1],0,0),c.inputPorts[1].connectInput(this.inputPorts[1],0,0);var d=c;this.outputPorts[0].connectInput(b.outputPorts[0],0,0),b.outputPorts[0].connectOutput(this.outputPorts[0],0,0),this.elements.push(b),this.elements.push(c);for(var b,e,c,f,g,h=1;h<this.bitWidth;h++)b=createInternalXOR(),e=createInternalXOR(),c=createInternalAND(),f=createInternalAND(),g=createInternalOR(),this.inputPorts[0].connectOutput(b.inputPorts[0],0,h),b.inputPorts[0].connectInput(this.inputPorts[0],0,h),this.inputPorts[1].connectOutput(b.inputPorts[1],0,h),b.inputPorts[1].connectInput(this.inputPorts[1],0,h),d.connectOutput(e,0),e.connectInput(d,0),b.connectOutput(e,1),e.connectInput(b,1),d.connectOutput(f,0),f.connectInput(d,0),b.connectOutput(f,1),f.connectInput(b,1),this.inputPorts[0].connectOutput(c.inputPorts[0],0,h),c.inputPorts[0].connectInput(this.inputPorts[0],0,h),this.inputPorts[1].connectOutput(c.inputPorts[1],0,h),c.inputPorts[1].connectInput(this.inputPorts[1],0,h),c.connectOutput(g,0),
g.connectInput(c,0),f.connectOutput(g,1),g.connectInput(f,1),this.outputPorts[0].connectInput(e.outputPorts[0],h,0),e.outputPorts[0].connectOutput(this.outputPorts[0],h,0),d=g,this.elements.push(b),this.elements.push(e),this.elements.push(c),this.elements.push(f),this.elements.push(g)},Component.prototype.getDisplayText=function(){var a="";switch(this.elementType){case Component.IN:a="Data in";break;case Component.OUT:a="Data out";break;case Component.ADDER:a="Adder";break;case Component.COMPARATOR:a="Comparator";break;case Component.MUX:a="2x1 mux";break;case Component.LOAD_REGISTER:a="Load register";break;case Component.CONSTANT:a="Constant data"}return a},Component.prototype.getDisplayTextDimensions=function(a){var b=1.3,c=15;return{width:a.measureText(this.getDisplayText()).width*b+c,height:24}},Component.prototype.draw=function(a){if(this.shouldDraw){if(!this.inToolBox){for(var b=0;b<this.inputPorts.length;b++)this.inputPorts[b].draw(a);for(var b=0;b<this.outputPorts.length;b++)this.outputPorts[b].draw(a)}if(this.inToolBox){a.save(),a.strokeStyle=COMPONENT_CONSTANTS.TOOLBOX_DRAWING.borderColor,this.elementType===Component.CONSTANT?a.fillStyle=COMPONENT_CONSTANTS.TOOLBOX_DRAWING.constantBackgroundColor:a.fillStyle=COMPONENT_CONSTANTS.TOOLBOX_DRAWING.normalBackgroundColor;var c=this.getDisplayText(),d=this.getDisplayTextDimensions(a);this.width=d.width,this.height=d.height,a.beginPath(),a.fillRect(this.x,this.y,this.width,this.height),a.rect(this.x,this.y,this.width,this.height),a.stroke(),a.fillStyle=COMPONENT_CONSTANTS.TOOLBOX_DRAWING.nameFontcolor,a.font=COMPONENT_CONSTANTS.TOOLBOX_DRAWING.nameFont,a.textBaseline="middle",a.fillText(c,this.x+5,this.y+this.height/2),a.restore()}else{a.save(),a.strokeStyle=COMPONENT_CONSTANTS.NORMAL_DRAWING.borderColor,this.elementType===Component.CONSTANT?a.fillStyle=COMPONENT_CONSTANTS.NORMAL_DRAWING.constantBackgroundColor:a.fillStyle=COMPONENT_CONSTANTS.NORMAL_DRAWING.normalBackgroundColor,a.globalAlpha=this.loading?.5:1,this.width=this.actualWidth,this.height=this.actualHeight,a.beginPath(),a.fillRect(this.x,this.y,this.width,this.height),a.rect(this.x,this.y,this.width,this.height),a.stroke();for(var b=0;b<this.inputPorts.length;b++)this.inputPorts[b].drawName(a);for(var b=0;b<this.outputPorts.length;b++)this.outputPorts[b].drawName(a);if(this.elementType==Component.IN||this.elementType==Component.OUT||this.elementType==Component.CONSTANT){var e=this.value+"";this.elementType!=Component.OUT||null!=this.inputs[0]&&-255!=this.value||(e="?"),a.fillStyle=COMPONENT_CONSTANTS.NORMAL_DRAWING.valueFontColor,a.font=COMPONENT_CONSTANTS.NORMAL_DRAWING.valueFont,a.textBaseline="middle",a.fillText(e,this.x+this.width/2-a.measureText(e).width/2,this.y+this.height/2),(this.elementType==Component.IN||this.elementType==Component.OUT)&&(a.fillStyle=COMPONENT_CONSTANTS.NORMAL_DRAWING.nameFontcolor,a.font=COMPONENT_CONSTANTS.NORMAL_DRAWING.nameFont,a.textBaseline="middle",a.fillText(this.name,this.x-this.width/4-a.measureText(this.name).width/2,this.y+this.height/2))}else a.fillStyle=COMPONENT_CONSTANTS.NORMAL_DRAWING.nameFontcolor,a.font=COMPONENT_CONSTANTS.NORMAL_DRAWING.nameFont,a.textBaseline="middle",a.fillText(this.name,this.x+this.width/2-a.measureText(this.name).width/2,this.y+this.height/2);a.restore()}}};var CANVAS_GRANULARITY=5,INTERSECTION={NO_INTERSECTION:0,COLLINEAR:1,DO_INTERSECT:2},CONTEXT_MENU_OPTIONS_VALUES={DELETE_WIRE:0},CONTEXT_MENU_OPTIONS=[CONTEXT_MENU_OPTIONS_VALUES.DELETE_WIRE],DRAW_INTERVAL=16,DEBUG=!1,ZYANTE_GREEN="#738033",ZYANTE_MEDIUM_RED="#BB0404",ZYANTE_DARK_ORANGE="#AB4600",DEFAULT_TEXT_COLOR="black",DEFAULT_WIDTH=640,DEFAULT_HEIGHT=480,NAMES={},WIRE_COLOR="black",WIRE_BUFFER=15,WIRE_LENGTH=20,HALF_WIRE_LENGTH=WIRE_LENGTH/2,QUARTER_WIRE_LENGTH=WIRE_LENGTH/4,ZYANTE_DARK_BLUE="#5780A6",ELEMENT_VALUES={FALSE:0,TRUE:1,UNDEFINED:-1},ELEMENT_FUNCTIONS=function(){function a(a){for(var b=ELEMENT_VALUES.TRUE,c=!1,d=0;d<a.inputPorts.length;d++)null!=a.inputPorts[d]&&a.inputPorts[d].connectors[0].value!=ELEMENT_VALUES.UNDEFINED?b=b&&a.inputPorts[d].connectors[0].value:c=!0;c&&b==ELEMENT_VALUES.TRUE&&(b=ELEMENT_VALUES.UNDEFINED),a.value=b}function b(a){for(var b=1,c=!1,d=0;d<a.inputPorts.length;d++)null!=a.inputPorts[d]&&a.inputPorts[d].connectors[0].value!=ELEMENT_VALUES.UNDEFINED?b=b&&a.inputPorts[d].connectors[0].value:c=!0;c&&b==ELEMENT_VALUES.TRUE&&(b=ELEMENT_VALUES.UNDEFINED),b==ELEMENT_VALUES.TRUE?b=ELEMENT_VALUES.FALSE:b==ELEMENT_VALUES.FALSE&&(b=ELEMENT_VALUES.TRUE),a.value=b}function c(a){for(var b=0,c=!1,d=0;d<a.inputPorts.length;d++)null!=a.inputPorts[d]&&a.inputPorts[d].connectors[0].value!=ELEMENT_VALUES.UNDEFINED?b=b||a.inputPorts[d].connectors[0].value:c=!0;c&&b==ELEMENT_VALUES.FALSE&&(b=ELEMENT_VALUES.UNDEFINED),a.value=b}function d(a){for(var b=0,c=!1,d=0;d<a.inputPorts.length;d++)null!=a.inputPorts[d]&&a.inputPorts[d].connectors[0].value!=ELEMENT_VALUES.UNDEFINED?b=b||a.inputPorts[d].connectors[0].value:c=!0;c&&b==ELEMENT_VALUES.FALSE&&(b=ELEMENT_VALUES.UNDEFINED),b==ELEMENT_VALUES.TRUE?b=ELEMENT_VALUES.FALSE:b==ELEMENT_VALUES.FALSE&&(b=ELEMENT_VALUES.TRUE),a.value=b}function e(a){for(var b=0;b<a.inputPorts.length;b++){if(null==a.inputPorts[b])return void(a.value=ELEMENT_VALUES.UNDEFINED);if(a.inputPorts[b].connectors[0].value==ELEMENT_VALUES.UNDEFINED)return void(a.value=ELEMENT_VALUES.UNDEFINED)}for(b=0;b<a.inputPorts.length;b++){a.value=a.inputPorts[b].connectors[0].value,b++;break}for(;b<a.inputPorts.length;b++){if(a.value==ELEMENT_VALUES.TRUE&&a.inputPorts[b].connectors[0].value==ELEMENT_VALUES.TRUE){a.value=ELEMENT_VALUES.FALSE;break}a.inputPorts[b].connectors[0].value==ELEMENT_VALUES.TRUE&&(a.value=ELEMENT_VALUES.TRUE)}}function f(a){a.inputPorts[0]?a.inputPorts[0].connectors[0].value==ELEMENT_VALUES.TRUE?a.value=ELEMENT_VALUES.FALSE:a.inputPorts[0].connectors[0].value==ELEMENT_VALUES.FALSE?a.value=ELEMENT_VALUES.TRUE:a.value=ELEMENT_VALUES.UNDEFINED:a.value=ELEMENT_VALUES.UNDEFINED}function g(a){1==a.value?a.img=ZyDigSim.imageAssets.oneImg:a.img=ZyDigSim.imageAssets.zeroImg}function h(a){a.inputPorts[0]?a.value=a.inputPorts[0].connectors[0].value:a.value=ELEMENT_VALUES.UNDEFINED,a.value==ELEMENT_VALUES.TRUE?a.img=ZyDigSim.imageAssets.oneImg:a.value==ELEMENT_VALUES.FALSE?a.img=ZyDigSim.imageAssets.zeroImg:a.value==ELEMENT_VALUES.UNDEFINED&&(a.img=ZyDigSim.imageAssets.undefinedImg)}function i(a){a.inputPorts[0]?a.value=a.inputPorts[0].connectors[0].value:a.value=ELEMENT_VALUES.UNDEFINED}function j(a){a.img=ZyDigSim.imageAssets.labelImg}function k(a){}return{AND:a,IN:g,OR:c,NOT:f,XOR:e,PASS:i,OUT:h,NAND:b,NOR:d,LABEL:j,NONE:k}}(),ELEMENT_CONSTANTS={nameFont:"16px Helvetica",nameFontColor:"black",valueFont:"12px Heletica"};Element.IN="in",Element.OUT="out",Element.AND="and",Element.OR="or",Element.PASS="pass",Element.LABEL="label",Element.NAND="nand",Element.NOR="nor",Element.XOR="xor",Element.NOT="not",Element.NONE="none",Element.prototype.update=function(){if(this.operation){this.updateDimensions({width:this.width,height:this.height});for(var a=0;a<this.inputPorts.length;a++)this.inputPorts[a].update();this.operation(this);for(var a=0;a<this.outputPorts.length;a++)this.outputPorts[a].connectors[0].value=this.value}},Element.prototype.moveTo=function(a,b){var c=a-this.x,d=b-this.y;this.x=a,this.y=b;for(var e=0;e<this.inputPorts.length;e++)this.inputPorts[e].x+=c,this.inputPorts[e].y+=d;for(var e=0;e<this.outputPorts.length;e++)this.outputPorts[e].x+=c,this.outputPorts[e].y+=d},Element.prototype.updateDimensions=function(a){if(this.inputPorts&&this.outputPorts){this.width=a.width,this.height=a.height;for(var b=this.height/(this.maxInput+1),c=0,d=b;c<this.inputPorts.length;c++,d+=b)this.inputPorts[c].x=this.x-HALF_WIRE_LENGTH,this.inputPorts[c].y=this.y+d;this.outputPorts.length>=1&&(this.outputPorts[0].x=this.x+this.width-HALF_WIRE_LENGTH,this.outputPorts[0].y=this.y+this.height/2)}},Element.prototype.draw=function(a){if(null!=this.img&&this.shouldDraw){for(var b=0;b<this.inputPorts.length;b++)this.inputPorts[b].draw(a);for(var b=0;b<this.outputPorts.length;b++)this.outputPorts[b].draw(a);a.save(),a.fillStyle=ELEMENT_CONSTANTS.nameFontColor,a.font=ELEMENT_CONSTANTS.nameFont,a.drawImage(this.img,this.x,this.y);var c=20;this.name&&(this.elementType==Element.IN?a.fillText(this.name,this.x-c-a.measureText(this.name).width/2,this.y+this.height/2):this.elementType==Element.OUT&&a.fillText(this.name,this.x+this.width+c-a.measureText(this.name).width/2,this.y+this.height/2));var d,e=5,f=-5;this.elementType==Element.OUT||this.inToolBox||(this.value==ELEMENT_VALUES.TRUE?(a.fillStyle=ZYANTE_GREEN,d=this.value):this.value==ELEMENT_VALUES.FALSE?(a.fillStyle=ZYANTE_MEDIUM_RED,d=this.value):this.value==ELEMENT_VALUES.UNDEFINED&&(a.fillStyle=DEFAULT_TEXT_COLOR,d="?"),a.font=ELEMENT_CONSTANTS.valueFont,a.fillText(d+"",this.x+this.width+e,this.y+this.height/2+f)),a.restore()}},Element.prototype.connectInput=function(a,b,c){void 0==c&&(c=0),this.inputPorts[b].connectInput(a.outputPorts[c]),this.inputs[b]=a},Element.prototype.connectOutput=function(a,b,c){void 0==c&&(c=0),this.outputPorts[c].connectOutput(a.inputPorts[b]),this.outputs.push({outputEle:a,inputIndex:b})},CanvasRenderingContext2D.prototype.dashedLine=function(a,b,c,d,e){void 0==e&&(e=2),this.moveTo(a,b);for(var f=c-a,g=d-b,h=Math.floor(Math.sqrt(f*f+g*g)/e),i=f/h,j=g/h,k=0;k++<h;)a+=i,b+=j,this[k%2==0?"moveTo":"lineTo"](a,b);this[k%2==0?"moveTo":"lineTo"](c,d)},InternalCell.prototype.connectInput=function(a){this.input=a},InternalCell.prototype.connectOutput=function(a){this.outputs.push({outputEle:a,inputIndex:0,portIndex:0})},InternalCell.prototype.update=function(){this.input&&(this.value=this.input.value)},Port.prototype.updateName=function(a,b){this.name=a,this.isOutput=b},Port.prototype.draw=function(a){a.save(),a.fillStyle=WIRE_COLOR,a.font="12px Helvetica",a.strokeStyle=WIRE_COLOR,a.lineWidth=1,this.vertical?(this.bitWidth>1&&(a.beginPath(),this.isOutput?(a.moveTo(this.x+QUARTER_WIRE_LENGTH,this.y+this.height/2),a.lineTo(this.x-QUARTER_WIRE_LENGTH,this.y+this.height)):(a.moveTo(this.x+QUARTER_WIRE_LENGTH,this.y),a.lineTo(this.x-QUARTER_WIRE_LENGTH,this.y+this.height/2)),a.stroke()),a.beginPath(),a.moveTo(this.x,this.y),a.lineTo(this.x,this.y+this.height),a.stroke(),a.restore()):(this.bitWidth>1&&(a.beginPath(),this.isOutput?(a.moveTo(this.x+this.width/2,this.y+QUARTER_WIRE_LENGTH),a.lineTo(this.x+this.width,this.y-QUARTER_WIRE_LENGTH)):(a.moveTo(this.x,this.y+QUARTER_WIRE_LENGTH),a.lineTo(this.x+this.width/2,this.y-QUARTER_WIRE_LENGTH)),a.stroke()),a.beginPath(),a.moveTo(this.x,this.y),a.lineTo(this.x+this.width,this.y),a.stroke(),a.restore())},Port.prototype.drawName=function(a){a.save(),a.fillStyle=WIRE_COLOR;var b=12;a.font=b+"px Helvetica",a.strokeStyle=WIRE_COLOR;var c=5;if(this.vertical)this.isOutput?(a.fillText(this.name,this.x-a.measureText(this.name).width/2,this.y),this.name&&(a.font="italic "+(b-2)+"px Helvetica",a.fillStyle="gray",a.fillText(this.value,this.x+a.measureText(this.name).width/2+c,this.y))):(a.fillText(this.name,this.x-a.measureText(this.name).width/2,this.y+this.height+5),this.name&&(a.font="italic "+(b-2)+"px Helvetica",a.fillStyle="gray",a.fillText(this.value,this.x+a.measureText(this.name).width/2+c,this.y+this.height+5)));else if(this.isOutput)a.fillText(this.name,this.x-a.measureText(this.name).width/2,this.y);else if("clk"==this.name){a.strokeStyle=ZYANTE_DARK_BLUE;var d=b,e=b;a.beginPath(),a.moveTo(this.x+this.width/2,this.y+d/2),a.lineTo(this.x+this.width/2,this.y-d/2),a.lineTo(this.x+this.width/2+e,this.y),a.lineTo(this.x+this.width/2,this.y+d/2),a.stroke()}else a.fillText(this.name,this.x+this.width-a.measureText(this.name).width/2,this.y);a.restore()},Port.prototype.connectInput=function(a,b,c){if(void 0!=b&&void 0!=c)this.connectors[b].connectInput(a.connectors[c]);else for(var d=0;d<this.bitWidth;d++)this.connectors[d].connectInput(a.connectors[d])},Port.prototype.connectOutput=function(a,b,c){if(void 0!=b&&void 0!=c)this.connectors[c].connectOutput(a.connectors[b]);else for(var d=0;d<this.bitWidth;d++)this.connectors[d].connectOutput(a.connectors[d])},Port.prototype.update=function(){for(var a=0,b=0;b<this.bitWidth;b++)this.connectors[b].update(),a|=this.connectors[b].value<<b;this.value=a},Port.prototype.endPoint=function(){return this.vertical?this.isOutput?{x:this.x,y:this.y+this.height}:{x:this.x,y:this.y}:this.isOutput?{x:this.x+this.width,y:this.y}:{x:this.x,y:this.y}};var zyDigSimExport={create:function(){return new ZyDigSim},dependencies:{tools:["progressionTool","utilities","discreteMathUtilities"]}};module.exports=zyDigSimExport,exports["default"]=module.exports});